(function() {
  window.SLConfig = {"active":true,"disabled":false,"test_mode":false,"scan_forms":true,"app_url":"https://dash.sparkloop.app","script_url":"https://js.sparkloop.app","uuid":"team_814d749d9e20","plan":"solo_creator_v3","provider":"mailchimp","form_selector":"form","campaigns":true,"widgets":{"referral_hubs":[{"campaign_id":"MFf6087262ac78","styling":{"colors":{"primary":"#d4a017","secondary":"#e2e8f0","headers":"#4b5563"},"custom_css":"#sl-form-screen {}\r\n#sl-form-screen \u003e section {}\r\n#sl-form-screen \u003e section h2 {}","powered_by_enabled":false},"form_widget":{"cover_image":{"enabled":true,"url":"https://dash.sparkloop.app/rails/active_storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBc3MyIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--4bb6df0eabff70cb96fc13fa07599a2982be6042/SFS%20Rewards%20gif.gif","position":"left"},"header":"Invite friends.\r\nEarn rewards.","subheader":"Get your friends to subscribe and earn rewards. The more subscribers you refer, the bigger the rewards.","form":{"name_input":{"enabled":false,"placeholder":"Your name"},"email_input":{"placeholder":"Your email"},"button":{"label":"Join"}},"tabs":{"how_it_works":{"enabled":true,"label":"How it works","content":"Share SFS Newsletter and Earn Rewards When Friends You Refer Subscribe:\r\n\r\n- Refer 5 friends to receive 2 Fabric Mini bands\r\n- Refer 10 friends to receive the SFS Hypertrophy Program\r\n- Refer 25 friends to receive SFS Always Ready Pre-Workout\r\n- Refer 50 friends to receive SFS Gym Bag\r\n\r\nQuestions? Email us at newsletter@setforset.com"},"terms":{"enabled":false,"label":"Terms \u0026 Conditions","url":""}}},"hub_widget":{"header":"Invite Friends. Earn Rewards.","subheader":"","rewards":{"enabled":true,"layout":"horizontal","list":[{"id":"reward_e5a85a439fa2","image":"https://dash.sparkloop.app/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBajAyIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--3ea2e63270def1c32a52422935faa847d6287c03/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lPTXpBd1BuZ3pNREErQmpvR1JWUT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--83ff9a9dbb0569e1243b731eed72c73e23168436/sfs%20fabric%20bands.jpg","name":"Fabric Bands","description":"Set of 2 mini fabric loop bands","referrals":5,"recurring":false},{"id":"reward_727753277ccf","image":"https://dash.sparkloop.app/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBajQyIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--fd8888a862d88f2e3704625d9bfa60c138a1947e/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lPTXpBd1BuZ3pNREErQmpvR1JWUT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--83ff9a9dbb0569e1243b731eed72c73e23168436/SFS%20hypertrophy%20program.jpg","name":"SFS Hypertrophy Program","description":"12 Week Muscle Building Program (digital download)","referrals":10,"recurring":false},{"id":"reward_d8380c864845","image":"https://dash.sparkloop.app/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBajgyIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--bb841b0b961766d667a62c517dcdd0735750a73f/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lPTXpBd1BuZ3pNREErQmpvR1JWUT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--83ff9a9dbb0569e1243b731eed72c73e23168436/SFS%20Always%20Ready%20Pre-Workout.jpg","name":"SFS Always Ready Pre-Workout","description":"Advanced Pre-Workout ","referrals":25,"recurring":false},{"id":"reward_39ff8f001108","image":"https://dash.sparkloop.app/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBa0EyIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--68807e0e0fbb5d5d9b2c377aeaf051600803427c/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lPTXpBd1BuZ3pNREErQmpvR1JWUT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--83ff9a9dbb0569e1243b731eed72c73e23168436/SFS%20gym%20bag.jpg","name":"SFS Gym Bag","description":"Premium SFS duffel bag","referrals":50,"recurring":false}]},"sharing":{"referral_link":{"header":"Share your referral link anywhere:","button":{"label":"Copy"}},"social_links":{"enabled":true,"header":"Or share with:","socials":{"twitter":{"enabled":true,"message":"I just signed up on this awesome newsletter!"},"facebook":{"enabled":true},"facebook_messenger":{"enabled":true},"email":{"enabled":true,"message":"I just signed up on this awesome newsletter!","subject":"Check this out"},"whatsapp":{"enabled":true,"message":"I just signed up on this awesome newsletter!"},"linkedin":{"enabled":true},"telegram":{"enabled":true,"message":"I just signed up on this awesome newsletter!"},"line":{"enabled":false,"message":"I just signed up on this awesome newsletter!"}}},"email_invitation":{"enabled":true,"header":"Send to friends via email","placeholder":"Comma separated emails (max 5)","button":{"label":"Send"},"confirmation_message":"The invites have been sent","email":{"subject":"Become stronger \u0026 smarter in 5 minutes","body":"Hey, I think you should check out SFS Newsletter. It’s a weekly email that highlights more than just fitness \u0026 health news. It's full of actionable content, training tips, interesting facts and challenges. It’s 100% free, only takes 5-10 minutes to read and will make you a stronger person both physically \u0026 mentally. \r\n\r\nClick my personal invite below and sign up: "}}},"referrals":{"confirmed":{"enabled":true,"label":"confirmed referrals"},"pending":{"enabled":true,"label":"pending referrals"},"next":{"enabled":true,"label":"referrals to next reward"}}}}],"upscribes":[],"upscribe_ref":"sparkloop-upscribe"}};
  (() => {
  var __create = Object.create;
  var __defProp = Object.defineProperty;
  var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
  var __getOwnPropNames = Object.getOwnPropertyNames;
  var __getProtoOf = Object.getPrototypeOf;
  var __hasOwnProp = Object.prototype.hasOwnProperty;
  var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
  var __commonJS = (cb, mod) => function __require() {
    return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
  };
  var __reExport = (target, module, copyDefault, desc) => {
    if (module && typeof module === "object" || typeof module === "function") {
      for (let key of __getOwnPropNames(module))
        if (!__hasOwnProp.call(target, key) && (copyDefault || key !== "default"))
          __defProp(target, key, { get: () => module[key], enumerable: !(desc = __getOwnPropDesc(module, key)) || desc.enumerable });
    }
    return target;
  };
  var __toESM = (module, isNodeMode) => {
    return __reExport(__markAsModule(__defProp(module != null ? __create(__getProtoOf(module)) : {}, "default", !isNodeMode && module && module.__esModule ? { get: () => module.default, enumerable: true } : { value: module, enumerable: true })), module);
  };

  // node_modules/fingerprintjs2/fingerprint2.js
  var require_fingerprint2 = __commonJS({
    "node_modules/fingerprintjs2/fingerprint2.js"(exports, module) {
      (function(name, context, definition) {
        "use strict";
        if (typeof window !== "undefined" && typeof define === "function" && define.amd) {
          define(definition);
        } else if (typeof module !== "undefined" && module.exports) {
          module.exports = definition();
        } else if (context.exports) {
          context.exports = definition();
        } else {
          context[name] = definition();
        }
      })("Fingerprint2", exports, function() {
        "use strict";
        if (typeof Array.isArray === "undefined") {
          Array.isArray = function(obj) {
            return Object.prototype.toString.call(obj) === "[object Array]";
          };
        }
        ;
        var x64Add = function(m, n2) {
          m = [m[0] >>> 16, m[0] & 65535, m[1] >>> 16, m[1] & 65535];
          n2 = [n2[0] >>> 16, n2[0] & 65535, n2[1] >>> 16, n2[1] & 65535];
          var o = [0, 0, 0, 0];
          o[3] += m[3] + n2[3];
          o[2] += o[3] >>> 16;
          o[3] &= 65535;
          o[2] += m[2] + n2[2];
          o[1] += o[2] >>> 16;
          o[2] &= 65535;
          o[1] += m[1] + n2[1];
          o[0] += o[1] >>> 16;
          o[1] &= 65535;
          o[0] += m[0] + n2[0];
          o[0] &= 65535;
          return [o[0] << 16 | o[1], o[2] << 16 | o[3]];
        };
        var x64Multiply = function(m, n2) {
          m = [m[0] >>> 16, m[0] & 65535, m[1] >>> 16, m[1] & 65535];
          n2 = [n2[0] >>> 16, n2[0] & 65535, n2[1] >>> 16, n2[1] & 65535];
          var o = [0, 0, 0, 0];
          o[3] += m[3] * n2[3];
          o[2] += o[3] >>> 16;
          o[3] &= 65535;
          o[2] += m[2] * n2[3];
          o[1] += o[2] >>> 16;
          o[2] &= 65535;
          o[2] += m[3] * n2[2];
          o[1] += o[2] >>> 16;
          o[2] &= 65535;
          o[1] += m[1] * n2[3];
          o[0] += o[1] >>> 16;
          o[1] &= 65535;
          o[1] += m[2] * n2[2];
          o[0] += o[1] >>> 16;
          o[1] &= 65535;
          o[1] += m[3] * n2[1];
          o[0] += o[1] >>> 16;
          o[1] &= 65535;
          o[0] += m[0] * n2[3] + m[1] * n2[2] + m[2] * n2[1] + m[3] * n2[0];
          o[0] &= 65535;
          return [o[0] << 16 | o[1], o[2] << 16 | o[3]];
        };
        var x64Rotl = function(m, n2) {
          n2 %= 64;
          if (n2 === 32) {
            return [m[1], m[0]];
          } else if (n2 < 32) {
            return [m[0] << n2 | m[1] >>> 32 - n2, m[1] << n2 | m[0] >>> 32 - n2];
          } else {
            n2 -= 32;
            return [m[1] << n2 | m[0] >>> 32 - n2, m[0] << n2 | m[1] >>> 32 - n2];
          }
        };
        var x64LeftShift = function(m, n2) {
          n2 %= 64;
          if (n2 === 0) {
            return m;
          } else if (n2 < 32) {
            return [m[0] << n2 | m[1] >>> 32 - n2, m[1] << n2];
          } else {
            return [m[1] << n2 - 32, 0];
          }
        };
        var x64Xor = function(m, n2) {
          return [m[0] ^ n2[0], m[1] ^ n2[1]];
        };
        var x64Fmix = function(h) {
          h = x64Xor(h, [0, h[0] >>> 1]);
          h = x64Multiply(h, [4283543511, 3981806797]);
          h = x64Xor(h, [0, h[0] >>> 1]);
          h = x64Multiply(h, [3301882366, 444984403]);
          h = x64Xor(h, [0, h[0] >>> 1]);
          return h;
        };
        var x64hash128 = function(key, seed) {
          key = key || "";
          seed = seed || 0;
          var remainder = key.length % 16;
          var bytes = key.length - remainder;
          var h1 = [0, seed];
          var h2 = [0, seed];
          var k1 = [0, 0];
          var k2 = [0, 0];
          var c1 = [2277735313, 289559509];
          var c2 = [1291169091, 658871167];
          for (var i = 0; i < bytes; i = i + 16) {
            k1 = [key.charCodeAt(i + 4) & 255 | (key.charCodeAt(i + 5) & 255) << 8 | (key.charCodeAt(i + 6) & 255) << 16 | (key.charCodeAt(i + 7) & 255) << 24, key.charCodeAt(i) & 255 | (key.charCodeAt(i + 1) & 255) << 8 | (key.charCodeAt(i + 2) & 255) << 16 | (key.charCodeAt(i + 3) & 255) << 24];
            k2 = [key.charCodeAt(i + 12) & 255 | (key.charCodeAt(i + 13) & 255) << 8 | (key.charCodeAt(i + 14) & 255) << 16 | (key.charCodeAt(i + 15) & 255) << 24, key.charCodeAt(i + 8) & 255 | (key.charCodeAt(i + 9) & 255) << 8 | (key.charCodeAt(i + 10) & 255) << 16 | (key.charCodeAt(i + 11) & 255) << 24];
            k1 = x64Multiply(k1, c1);
            k1 = x64Rotl(k1, 31);
            k1 = x64Multiply(k1, c2);
            h1 = x64Xor(h1, k1);
            h1 = x64Rotl(h1, 27);
            h1 = x64Add(h1, h2);
            h1 = x64Add(x64Multiply(h1, [0, 5]), [0, 1390208809]);
            k2 = x64Multiply(k2, c2);
            k2 = x64Rotl(k2, 33);
            k2 = x64Multiply(k2, c1);
            h2 = x64Xor(h2, k2);
            h2 = x64Rotl(h2, 31);
            h2 = x64Add(h2, h1);
            h2 = x64Add(x64Multiply(h2, [0, 5]), [0, 944331445]);
          }
          k1 = [0, 0];
          k2 = [0, 0];
          switch (remainder) {
            case 15:
              k2 = x64Xor(k2, x64LeftShift([0, key.charCodeAt(i + 14)], 48));
            case 14:
              k2 = x64Xor(k2, x64LeftShift([0, key.charCodeAt(i + 13)], 40));
            case 13:
              k2 = x64Xor(k2, x64LeftShift([0, key.charCodeAt(i + 12)], 32));
            case 12:
              k2 = x64Xor(k2, x64LeftShift([0, key.charCodeAt(i + 11)], 24));
            case 11:
              k2 = x64Xor(k2, x64LeftShift([0, key.charCodeAt(i + 10)], 16));
            case 10:
              k2 = x64Xor(k2, x64LeftShift([0, key.charCodeAt(i + 9)], 8));
            case 9:
              k2 = x64Xor(k2, [0, key.charCodeAt(i + 8)]);
              k2 = x64Multiply(k2, c2);
              k2 = x64Rotl(k2, 33);
              k2 = x64Multiply(k2, c1);
              h2 = x64Xor(h2, k2);
            case 8:
              k1 = x64Xor(k1, x64LeftShift([0, key.charCodeAt(i + 7)], 56));
            case 7:
              k1 = x64Xor(k1, x64LeftShift([0, key.charCodeAt(i + 6)], 48));
            case 6:
              k1 = x64Xor(k1, x64LeftShift([0, key.charCodeAt(i + 5)], 40));
            case 5:
              k1 = x64Xor(k1, x64LeftShift([0, key.charCodeAt(i + 4)], 32));
            case 4:
              k1 = x64Xor(k1, x64LeftShift([0, key.charCodeAt(i + 3)], 24));
            case 3:
              k1 = x64Xor(k1, x64LeftShift([0, key.charCodeAt(i + 2)], 16));
            case 2:
              k1 = x64Xor(k1, x64LeftShift([0, key.charCodeAt(i + 1)], 8));
            case 1:
              k1 = x64Xor(k1, [0, key.charCodeAt(i)]);
              k1 = x64Multiply(k1, c1);
              k1 = x64Rotl(k1, 31);
              k1 = x64Multiply(k1, c2);
              h1 = x64Xor(h1, k1);
          }
          h1 = x64Xor(h1, [0, key.length]);
          h2 = x64Xor(h2, [0, key.length]);
          h1 = x64Add(h1, h2);
          h2 = x64Add(h2, h1);
          h1 = x64Fmix(h1);
          h2 = x64Fmix(h2);
          h1 = x64Add(h1, h2);
          h2 = x64Add(h2, h1);
          return ("00000000" + (h1[0] >>> 0).toString(16)).slice(-8) + ("00000000" + (h1[1] >>> 0).toString(16)).slice(-8) + ("00000000" + (h2[0] >>> 0).toString(16)).slice(-8) + ("00000000" + (h2[1] >>> 0).toString(16)).slice(-8);
        };
        var defaultOptions = {
          preprocessor: null,
          audio: {
            timeout: 1e3,
            excludeIOS11: true
          },
          fonts: {
            swfContainerId: "fingerprintjs2",
            swfPath: "flash/compiled/FontList.swf",
            userDefinedFonts: [],
            extendedJsFonts: false
          },
          screen: {
            detectScreenOrientation: true
          },
          plugins: {
            sortPluginsFor: [/palemoon/i],
            excludeIE: false
          },
          extraComponents: [],
          excludes: {
            "enumerateDevices": true,
            "pixelRatio": true,
            "doNotTrack": true,
            "fontsFlash": true,
            "adBlock": true
          },
          NOT_AVAILABLE: "not available",
          ERROR: "error",
          EXCLUDED: "excluded"
        };
        var each = function(obj, iterator) {
          if (Array.prototype.forEach && obj.forEach === Array.prototype.forEach) {
            obj.forEach(iterator);
          } else if (obj.length === +obj.length) {
            for (var i = 0, l = obj.length; i < l; i++) {
              iterator(obj[i], i, obj);
            }
          } else {
            for (var key in obj) {
              if (obj.hasOwnProperty(key)) {
                iterator(obj[key], key, obj);
              }
            }
          }
        };
        var map = function(obj, iterator) {
          var results = [];
          if (obj == null) {
            return results;
          }
          if (Array.prototype.map && obj.map === Array.prototype.map) {
            return obj.map(iterator);
          }
          each(obj, function(value, index, list) {
            results.push(iterator(value, index, list));
          });
          return results;
        };
        var extendSoft = function(target, source) {
          if (source == null) {
            return target;
          }
          var value;
          var key;
          for (key in source) {
            value = source[key];
            if (value != null && !Object.prototype.hasOwnProperty.call(target, key)) {
              target[key] = value;
            }
          }
          return target;
        };
        var enumerateDevicesKey = function(done, options) {
          if (!isEnumerateDevicesSupported()) {
            return done(options.NOT_AVAILABLE);
          }
          navigator.mediaDevices.enumerateDevices().then(function(devices) {
            done(devices.map(function(device) {
              return "id=" + device.deviceId + ";gid=" + device.groupId + ";" + device.kind + ";" + device.label;
            }));
          }).catch(function(error2) {
            done(error2);
          });
        };
        var isEnumerateDevicesSupported = function() {
          return navigator.mediaDevices && navigator.mediaDevices.enumerateDevices;
        };
        var audioKey = function(done, options) {
          var audioOptions = options.audio;
          if (audioOptions.excludeIOS11 && navigator.userAgent.match(/OS 11.+Version\/11.+Safari/)) {
            return done(options.EXCLUDED);
          }
          var AudioContext = window.OfflineAudioContext || window.webkitOfflineAudioContext;
          if (AudioContext == null) {
            return done(options.NOT_AVAILABLE);
          }
          var context = new AudioContext(1, 44100, 44100);
          var oscillator = context.createOscillator();
          oscillator.type = "triangle";
          oscillator.frequency.setValueAtTime(1e4, context.currentTime);
          var compressor = context.createDynamicsCompressor();
          each([
            ["threshold", -50],
            ["knee", 40],
            ["ratio", 12],
            ["reduction", -20],
            ["attack", 0],
            ["release", 0.25]
          ], function(item) {
            if (compressor[item[0]] !== void 0 && typeof compressor[item[0]].setValueAtTime === "function") {
              compressor[item[0]].setValueAtTime(item[1], context.currentTime);
            }
          });
          oscillator.connect(compressor);
          compressor.connect(context.destination);
          oscillator.start(0);
          context.startRendering();
          var audioTimeoutId = setTimeout(function() {
            console.warn('Audio fingerprint timed out. Please report bug at https://github.com/fingerprintjs/fingerprintjs with your user agent: "' + navigator.userAgent + '".');
            context.oncomplete = function() {
            };
            context = null;
            return done("audioTimeout");
          }, audioOptions.timeout);
          context.oncomplete = function(event) {
            var fingerprint;
            try {
              clearTimeout(audioTimeoutId);
              fingerprint = event.renderedBuffer.getChannelData(0).slice(4500, 5e3).reduce(function(acc, val) {
                return acc + Math.abs(val);
              }, 0).toString();
              oscillator.disconnect();
              compressor.disconnect();
            } catch (error2) {
              done(error2);
              return;
            }
            done(fingerprint);
          };
        };
        var UserAgent = function(done) {
          done(navigator.userAgent);
        };
        var webdriver = function(done, options) {
          done(navigator.webdriver == null ? options.NOT_AVAILABLE : navigator.webdriver);
        };
        var languageKey = function(done, options) {
          done(navigator.language || navigator.userLanguage || navigator.browserLanguage || navigator.systemLanguage || options.NOT_AVAILABLE);
        };
        var colorDepthKey = function(done, options) {
          done(window.screen.colorDepth || options.NOT_AVAILABLE);
        };
        var deviceMemoryKey = function(done, options) {
          done(navigator.deviceMemory || options.NOT_AVAILABLE);
        };
        var pixelRatioKey = function(done, options) {
          done(window.devicePixelRatio || options.NOT_AVAILABLE);
        };
        var screenResolutionKey = function(done, options) {
          done(getScreenResolution(options));
        };
        var getScreenResolution = function(options) {
          var resolution = [window.screen.width, window.screen.height];
          if (options.screen.detectScreenOrientation) {
            resolution.sort().reverse();
          }
          return resolution;
        };
        var availableScreenResolutionKey = function(done, options) {
          done(getAvailableScreenResolution(options));
        };
        var getAvailableScreenResolution = function(options) {
          if (window.screen.availWidth && window.screen.availHeight) {
            var available = [window.screen.availHeight, window.screen.availWidth];
            if (options.screen.detectScreenOrientation) {
              available.sort().reverse();
            }
            return available;
          }
          return options.NOT_AVAILABLE;
        };
        var timezoneOffset = function(done) {
          done(new Date().getTimezoneOffset());
        };
        var timezone = function(done, options) {
          if (window.Intl && window.Intl.DateTimeFormat) {
            done(new window.Intl.DateTimeFormat().resolvedOptions().timeZone || options.NOT_AVAILABLE);
            return;
          }
          done(options.NOT_AVAILABLE);
        };
        var sessionStorageKey = function(done, options) {
          done(hasSessionStorage(options));
        };
        var localStorageKey = function(done, options) {
          done(hasLocalStorage(options));
        };
        var indexedDbKey = function(done, options) {
          done(hasIndexedDB(options));
        };
        var addBehaviorKey = function(done) {
          done(!!window.HTMLElement.prototype.addBehavior);
        };
        var openDatabaseKey = function(done) {
          done(!!window.openDatabase);
        };
        var cpuClassKey = function(done, options) {
          done(getNavigatorCpuClass(options));
        };
        var platformKey = function(done, options) {
          done(getNavigatorPlatform(options));
        };
        var doNotTrackKey = function(done, options) {
          done(getDoNotTrack(options));
        };
        var canvasKey = function(done, options) {
          if (isCanvasSupported()) {
            done(getCanvasFp(options));
            return;
          }
          done(options.NOT_AVAILABLE);
        };
        var webglKey = function(done, options) {
          if (isWebGlSupported()) {
            done(getWebglFp());
            return;
          }
          done(options.NOT_AVAILABLE);
        };
        var webglVendorAndRendererKey = function(done) {
          if (isWebGlSupported()) {
            done(getWebglVendorAndRenderer());
            return;
          }
          done();
        };
        var adBlockKey = function(done) {
          done(getAdBlock());
        };
        var hasLiedLanguagesKey = function(done) {
          done(getHasLiedLanguages());
        };
        var hasLiedResolutionKey = function(done) {
          done(getHasLiedResolution());
        };
        var hasLiedOsKey = function(done) {
          done(getHasLiedOs());
        };
        var hasLiedBrowserKey = function(done) {
          done(getHasLiedBrowser());
        };
        var flashFontsKey = function(done, options) {
          if (!hasSwfObjectLoaded()) {
            return done("swf object not loaded");
          }
          if (!hasMinFlashInstalled()) {
            return done("flash not installed");
          }
          if (!options.fonts.swfPath) {
            return done("missing options.fonts.swfPath");
          }
          loadSwfAndDetectFonts(function(fonts) {
            done(fonts);
          }, options);
        };
        var jsFontsKey = function(done, options) {
          var baseFonts = ["monospace", "sans-serif", "serif"];
          var fontList = [
            "Andale Mono",
            "Arial",
            "Arial Black",
            "Arial Hebrew",
            "Arial MT",
            "Arial Narrow",
            "Arial Rounded MT Bold",
            "Arial Unicode MS",
            "Bitstream Vera Sans Mono",
            "Book Antiqua",
            "Bookman Old Style",
            "Calibri",
            "Cambria",
            "Cambria Math",
            "Century",
            "Century Gothic",
            "Century Schoolbook",
            "Comic Sans",
            "Comic Sans MS",
            "Consolas",
            "Courier",
            "Courier New",
            "Geneva",
            "Georgia",
            "Helvetica",
            "Helvetica Neue",
            "Impact",
            "Lucida Bright",
            "Lucida Calligraphy",
            "Lucida Console",
            "Lucida Fax",
            "LUCIDA GRANDE",
            "Lucida Handwriting",
            "Lucida Sans",
            "Lucida Sans Typewriter",
            "Lucida Sans Unicode",
            "Microsoft Sans Serif",
            "Monaco",
            "Monotype Corsiva",
            "MS Gothic",
            "MS Outlook",
            "MS PGothic",
            "MS Reference Sans Serif",
            "MS Sans Serif",
            "MS Serif",
            "MYRIAD",
            "MYRIAD PRO",
            "Palatino",
            "Palatino Linotype",
            "Segoe Print",
            "Segoe Script",
            "Segoe UI",
            "Segoe UI Light",
            "Segoe UI Semibold",
            "Segoe UI Symbol",
            "Tahoma",
            "Times",
            "Times New Roman",
            "Times New Roman PS",
            "Trebuchet MS",
            "Verdana",
            "Wingdings",
            "Wingdings 2",
            "Wingdings 3"
          ];
          if (options.fonts.extendedJsFonts) {
            var extendedFontList = [
              "Abadi MT Condensed Light",
              "Academy Engraved LET",
              "ADOBE CASLON PRO",
              "Adobe Garamond",
              "ADOBE GARAMOND PRO",
              "Agency FB",
              "Aharoni",
              "Albertus Extra Bold",
              "Albertus Medium",
              "Algerian",
              "Amazone BT",
              "American Typewriter",
              "American Typewriter Condensed",
              "AmerType Md BT",
              "Andalus",
              "Angsana New",
              "AngsanaUPC",
              "Antique Olive",
              "Aparajita",
              "Apple Chancery",
              "Apple Color Emoji",
              "Apple SD Gothic Neo",
              "Arabic Typesetting",
              "ARCHER",
              "ARNO PRO",
              "Arrus BT",
              "Aurora Cn BT",
              "AvantGarde Bk BT",
              "AvantGarde Md BT",
              "AVENIR",
              "Ayuthaya",
              "Bandy",
              "Bangla Sangam MN",
              "Bank Gothic",
              "BankGothic Md BT",
              "Baskerville",
              "Baskerville Old Face",
              "Batang",
              "BatangChe",
              "Bauer Bodoni",
              "Bauhaus 93",
              "Bazooka",
              "Bell MT",
              "Bembo",
              "Benguiat Bk BT",
              "Berlin Sans FB",
              "Berlin Sans FB Demi",
              "Bernard MT Condensed",
              "BernhardFashion BT",
              "BernhardMod BT",
              "Big Caslon",
              "BinnerD",
              "Blackadder ITC",
              "BlairMdITC TT",
              "Bodoni 72",
              "Bodoni 72 Oldstyle",
              "Bodoni 72 Smallcaps",
              "Bodoni MT",
              "Bodoni MT Black",
              "Bodoni MT Condensed",
              "Bodoni MT Poster Compressed",
              "Bookshelf Symbol 7",
              "Boulder",
              "Bradley Hand",
              "Bradley Hand ITC",
              "Bremen Bd BT",
              "Britannic Bold",
              "Broadway",
              "Browallia New",
              "BrowalliaUPC",
              "Brush Script MT",
              "Californian FB",
              "Calisto MT",
              "Calligrapher",
              "Candara",
              "CaslonOpnface BT",
              "Castellar",
              "Centaur",
              "Cezanne",
              "CG Omega",
              "CG Times",
              "Chalkboard",
              "Chalkboard SE",
              "Chalkduster",
              "Charlesworth",
              "Charter Bd BT",
              "Charter BT",
              "Chaucer",
              "ChelthmITC Bk BT",
              "Chiller",
              "Clarendon",
              "Clarendon Condensed",
              "CloisterBlack BT",
              "Cochin",
              "Colonna MT",
              "Constantia",
              "Cooper Black",
              "Copperplate",
              "Copperplate Gothic",
              "Copperplate Gothic Bold",
              "Copperplate Gothic Light",
              "CopperplGoth Bd BT",
              "Corbel",
              "Cordia New",
              "CordiaUPC",
              "Cornerstone",
              "Coronet",
              "Cuckoo",
              "Curlz MT",
              "DaunPenh",
              "Dauphin",
              "David",
              "DB LCD Temp",
              "DELICIOUS",
              "Denmark",
              "DFKai-SB",
              "Didot",
              "DilleniaUPC",
              "DIN",
              "DokChampa",
              "Dotum",
              "DotumChe",
              "Ebrima",
              "Edwardian Script ITC",
              "Elephant",
              "English 111 Vivace BT",
              "Engravers MT",
              "EngraversGothic BT",
              "Eras Bold ITC",
              "Eras Demi ITC",
              "Eras Light ITC",
              "Eras Medium ITC",
              "EucrosiaUPC",
              "Euphemia",
              "Euphemia UCAS",
              "EUROSTILE",
              "Exotc350 Bd BT",
              "FangSong",
              "Felix Titling",
              "Fixedsys",
              "FONTIN",
              "Footlight MT Light",
              "Forte",
              "FrankRuehl",
              "Fransiscan",
              "Freefrm721 Blk BT",
              "FreesiaUPC",
              "Freestyle Script",
              "French Script MT",
              "FrnkGothITC Bk BT",
              "Fruitger",
              "FRUTIGER",
              "Futura",
              "Futura Bk BT",
              "Futura Lt BT",
              "Futura Md BT",
              "Futura ZBlk BT",
              "FuturaBlack BT",
              "Gabriola",
              "Galliard BT",
              "Gautami",
              "Geeza Pro",
              "Geometr231 BT",
              "Geometr231 Hv BT",
              "Geometr231 Lt BT",
              "GeoSlab 703 Lt BT",
              "GeoSlab 703 XBd BT",
              "Gigi",
              "Gill Sans",
              "Gill Sans MT",
              "Gill Sans MT Condensed",
              "Gill Sans MT Ext Condensed Bold",
              "Gill Sans Ultra Bold",
              "Gill Sans Ultra Bold Condensed",
              "Gisha",
              "Gloucester MT Extra Condensed",
              "GOTHAM",
              "GOTHAM BOLD",
              "Goudy Old Style",
              "Goudy Stout",
              "GoudyHandtooled BT",
              "GoudyOLSt BT",
              "Gujarati Sangam MN",
              "Gulim",
              "GulimChe",
              "Gungsuh",
              "GungsuhChe",
              "Gurmukhi MN",
              "Haettenschweiler",
              "Harlow Solid Italic",
              "Harrington",
              "Heather",
              "Heiti SC",
              "Heiti TC",
              "HELV",
              "Herald",
              "High Tower Text",
              "Hiragino Kaku Gothic ProN",
              "Hiragino Mincho ProN",
              "Hoefler Text",
              "Humanst 521 Cn BT",
              "Humanst521 BT",
              "Humanst521 Lt BT",
              "Imprint MT Shadow",
              "Incised901 Bd BT",
              "Incised901 BT",
              "Incised901 Lt BT",
              "INCONSOLATA",
              "Informal Roman",
              "Informal011 BT",
              "INTERSTATE",
              "IrisUPC",
              "Iskoola Pota",
              "JasmineUPC",
              "Jazz LET",
              "Jenson",
              "Jester",
              "Jokerman",
              "Juice ITC",
              "Kabel Bk BT",
              "Kabel Ult BT",
              "Kailasa",
              "KaiTi",
              "Kalinga",
              "Kannada Sangam MN",
              "Kartika",
              "Kaufmann Bd BT",
              "Kaufmann BT",
              "Khmer UI",
              "KodchiangUPC",
              "Kokila",
              "Korinna BT",
              "Kristen ITC",
              "Krungthep",
              "Kunstler Script",
              "Lao UI",
              "Latha",
              "Leelawadee",
              "Letter Gothic",
              "Levenim MT",
              "LilyUPC",
              "Lithograph",
              "Lithograph Light",
              "Long Island",
              "Lydian BT",
              "Magneto",
              "Maiandra GD",
              "Malayalam Sangam MN",
              "Malgun Gothic",
              "Mangal",
              "Marigold",
              "Marion",
              "Marker Felt",
              "Market",
              "Marlett",
              "Matisse ITC",
              "Matura MT Script Capitals",
              "Meiryo",
              "Meiryo UI",
              "Microsoft Himalaya",
              "Microsoft JhengHei",
              "Microsoft New Tai Lue",
              "Microsoft PhagsPa",
              "Microsoft Tai Le",
              "Microsoft Uighur",
              "Microsoft YaHei",
              "Microsoft Yi Baiti",
              "MingLiU",
              "MingLiU_HKSCS",
              "MingLiU_HKSCS-ExtB",
              "MingLiU-ExtB",
              "Minion",
              "Minion Pro",
              "Miriam",
              "Miriam Fixed",
              "Mistral",
              "Modern",
              "Modern No. 20",
              "Mona Lisa Solid ITC TT",
              "Mongolian Baiti",
              "MONO",
              "MoolBoran",
              "Mrs Eaves",
              "MS LineDraw",
              "MS Mincho",
              "MS PMincho",
              "MS Reference Specialty",
              "MS UI Gothic",
              "MT Extra",
              "MUSEO",
              "MV Boli",
              "Nadeem",
              "Narkisim",
              "NEVIS",
              "News Gothic",
              "News GothicMT",
              "NewsGoth BT",
              "Niagara Engraved",
              "Niagara Solid",
              "Noteworthy",
              "NSimSun",
              "Nyala",
              "OCR A Extended",
              "Old Century",
              "Old English Text MT",
              "Onyx",
              "Onyx BT",
              "OPTIMA",
              "Oriya Sangam MN",
              "OSAKA",
              "OzHandicraft BT",
              "Palace Script MT",
              "Papyrus",
              "Parchment",
              "Party LET",
              "Pegasus",
              "Perpetua",
              "Perpetua Titling MT",
              "PetitaBold",
              "Pickwick",
              "Plantagenet Cherokee",
              "Playbill",
              "PMingLiU",
              "PMingLiU-ExtB",
              "Poor Richard",
              "Poster",
              "PosterBodoni BT",
              "PRINCETOWN LET",
              "Pristina",
              "PTBarnum BT",
              "Pythagoras",
              "Raavi",
              "Rage Italic",
              "Ravie",
              "Ribbon131 Bd BT",
              "Rockwell",
              "Rockwell Condensed",
              "Rockwell Extra Bold",
              "Rod",
              "Roman",
              "Sakkal Majalla",
              "Santa Fe LET",
              "Savoye LET",
              "Sceptre",
              "Script",
              "Script MT Bold",
              "SCRIPTINA",
              "Serifa",
              "Serifa BT",
              "Serifa Th BT",
              "ShelleyVolante BT",
              "Sherwood",
              "Shonar Bangla",
              "Showcard Gothic",
              "Shruti",
              "Signboard",
              "SILKSCREEN",
              "SimHei",
              "Simplified Arabic",
              "Simplified Arabic Fixed",
              "SimSun",
              "SimSun-ExtB",
              "Sinhala Sangam MN",
              "Sketch Rockwell",
              "Skia",
              "Small Fonts",
              "Snap ITC",
              "Snell Roundhand",
              "Socket",
              "Souvenir Lt BT",
              "Staccato222 BT",
              "Steamer",
              "Stencil",
              "Storybook",
              "Styllo",
              "Subway",
              "Swis721 BlkEx BT",
              "Swiss911 XCm BT",
              "Sylfaen",
              "Synchro LET",
              "System",
              "Tamil Sangam MN",
              "Technical",
              "Teletype",
              "Telugu Sangam MN",
              "Tempus Sans ITC",
              "Terminal",
              "Thonburi",
              "Traditional Arabic",
              "Trajan",
              "TRAJAN PRO",
              "Tristan",
              "Tubular",
              "Tunga",
              "Tw Cen MT",
              "Tw Cen MT Condensed",
              "Tw Cen MT Condensed Extra Bold",
              "TypoUpright BT",
              "Unicorn",
              "Univers",
              "Univers CE 55 Medium",
              "Univers Condensed",
              "Utsaah",
              "Vagabond",
              "Vani",
              "Vijaya",
              "Viner Hand ITC",
              "VisualUI",
              "Vivaldi",
              "Vladimir Script",
              "Vrinda",
              "Westminster",
              "WHITNEY",
              "Wide Latin",
              "ZapfEllipt BT",
              "ZapfHumnst BT",
              "ZapfHumnst Dm BT",
              "Zapfino",
              "Zurich BlkEx BT",
              "Zurich Ex BT",
              "ZWAdobeF"
            ];
            fontList = fontList.concat(extendedFontList);
          }
          fontList = fontList.concat(options.fonts.userDefinedFonts);
          fontList = fontList.filter(function(font, position) {
            return fontList.indexOf(font) === position;
          });
          var testString = "mmmmmmmmmmlli";
          var testSize = "72px";
          var h = document.getElementsByTagName("body")[0];
          var baseFontsDiv = document.createElement("div");
          var fontsDiv = document.createElement("div");
          var defaultWidth = {};
          var defaultHeight = {};
          var createSpan = function() {
            var s = document.createElement("span");
            s.style.position = "absolute";
            s.style.left = "-9999px";
            s.style.fontSize = testSize;
            s.style.fontStyle = "normal";
            s.style.fontWeight = "normal";
            s.style.letterSpacing = "normal";
            s.style.lineBreak = "auto";
            s.style.lineHeight = "normal";
            s.style.textTransform = "none";
            s.style.textAlign = "left";
            s.style.textDecoration = "none";
            s.style.textShadow = "none";
            s.style.whiteSpace = "normal";
            s.style.wordBreak = "normal";
            s.style.wordSpacing = "normal";
            s.innerHTML = testString;
            return s;
          };
          var createSpanWithFonts = function(fontToDetect, baseFont) {
            var s = createSpan();
            s.style.fontFamily = "'" + fontToDetect + "'," + baseFont;
            return s;
          };
          var initializeBaseFontsSpans = function() {
            var spans = [];
            for (var index2 = 0, length2 = baseFonts.length; index2 < length2; index2++) {
              var s = createSpan();
              s.style.fontFamily = baseFonts[index2];
              baseFontsDiv.appendChild(s);
              spans.push(s);
            }
            return spans;
          };
          var initializeFontsSpans = function() {
            var spans = {};
            for (var i2 = 0, l2 = fontList.length; i2 < l2; i2++) {
              var fontSpans = [];
              for (var j = 0, numDefaultFonts = baseFonts.length; j < numDefaultFonts; j++) {
                var s = createSpanWithFonts(fontList[i2], baseFonts[j]);
                fontsDiv.appendChild(s);
                fontSpans.push(s);
              }
              spans[fontList[i2]] = fontSpans;
            }
            return spans;
          };
          var isFontAvailable = function(fontSpans) {
            var detected = false;
            for (var i2 = 0; i2 < baseFonts.length; i2++) {
              detected = fontSpans[i2].offsetWidth !== defaultWidth[baseFonts[i2]] || fontSpans[i2].offsetHeight !== defaultHeight[baseFonts[i2]];
              if (detected) {
                return detected;
              }
            }
            return detected;
          };
          var baseFontsSpans = initializeBaseFontsSpans();
          h.appendChild(baseFontsDiv);
          for (var index = 0, length = baseFonts.length; index < length; index++) {
            defaultWidth[baseFonts[index]] = baseFontsSpans[index].offsetWidth;
            defaultHeight[baseFonts[index]] = baseFontsSpans[index].offsetHeight;
          }
          var fontsSpans = initializeFontsSpans();
          h.appendChild(fontsDiv);
          var available = [];
          for (var i = 0, l = fontList.length; i < l; i++) {
            if (isFontAvailable(fontsSpans[fontList[i]])) {
              available.push(fontList[i]);
            }
          }
          h.removeChild(fontsDiv);
          h.removeChild(baseFontsDiv);
          done(available);
        };
        var pluginsComponent = function(done, options) {
          if (isIE()) {
            if (!options.plugins.excludeIE) {
              done(getIEPlugins(options));
            } else {
              done(options.EXCLUDED);
            }
          } else {
            done(getRegularPlugins(options));
          }
        };
        var getRegularPlugins = function(options) {
          if (navigator.plugins == null) {
            return options.NOT_AVAILABLE;
          }
          var plugins = [];
          for (var i = 0, l = navigator.plugins.length; i < l; i++) {
            if (navigator.plugins[i]) {
              plugins.push(navigator.plugins[i]);
            }
          }
          if (pluginsShouldBeSorted(options)) {
            plugins = plugins.sort(function(a, b) {
              if (a.name > b.name) {
                return 1;
              }
              if (a.name < b.name) {
                return -1;
              }
              return 0;
            });
          }
          return map(plugins, function(p) {
            var mimeTypes = map(p, function(mt) {
              return [mt.type, mt.suffixes];
            });
            return [p.name, p.description, mimeTypes];
          });
        };
        var getIEPlugins = function(options) {
          var result = [];
          if (Object.getOwnPropertyDescriptor && Object.getOwnPropertyDescriptor(window, "ActiveXObject") || "ActiveXObject" in window) {
            var names = [
              "AcroPDF.PDF",
              "Adodb.Stream",
              "AgControl.AgControl",
              "DevalVRXCtrl.DevalVRXCtrl.1",
              "MacromediaFlashPaper.MacromediaFlashPaper",
              "Msxml2.DOMDocument",
              "Msxml2.XMLHTTP",
              "PDF.PdfCtrl",
              "QuickTime.QuickTime",
              "QuickTimeCheckObject.QuickTimeCheck.1",
              "RealPlayer",
              "RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)",
              "RealVideo.RealVideo(tm) ActiveX Control (32-bit)",
              "Scripting.Dictionary",
              "SWCtl.SWCtl",
              "Shell.UIHelper",
              "ShockwaveFlash.ShockwaveFlash",
              "Skype.Detection",
              "TDCCtl.TDCCtl",
              "WMPlayer.OCX",
              "rmocx.RealPlayer G2 Control",
              "rmocx.RealPlayer G2 Control.1"
            ];
            result = map(names, function(name) {
              try {
                new window.ActiveXObject(name);
                return name;
              } catch (e3) {
                return options.ERROR;
              }
            });
          } else {
            result.push(options.NOT_AVAILABLE);
          }
          if (navigator.plugins) {
            result = result.concat(getRegularPlugins(options));
          }
          return result;
        };
        var pluginsShouldBeSorted = function(options) {
          var should = false;
          for (var i = 0, l = options.plugins.sortPluginsFor.length; i < l; i++) {
            var re = options.plugins.sortPluginsFor[i];
            if (navigator.userAgent.match(re)) {
              should = true;
              break;
            }
          }
          return should;
        };
        var touchSupportKey = function(done) {
          done(getTouchSupport());
        };
        var hardwareConcurrencyKey = function(done, options) {
          done(getHardwareConcurrency(options));
        };
        var hasSessionStorage = function(options) {
          try {
            return !!window.sessionStorage;
          } catch (e3) {
            return options.ERROR;
          }
        };
        var hasLocalStorage = function(options) {
          try {
            return !!window.localStorage;
          } catch (e3) {
            return options.ERROR;
          }
        };
        var hasIndexedDB = function(options) {
          if (isIEOrOldEdge()) {
            return options.EXCLUDED;
          }
          try {
            return !!window.indexedDB;
          } catch (e3) {
            return options.ERROR;
          }
        };
        var getHardwareConcurrency = function(options) {
          if (navigator.hardwareConcurrency) {
            return navigator.hardwareConcurrency;
          }
          return options.NOT_AVAILABLE;
        };
        var getNavigatorCpuClass = function(options) {
          return navigator.cpuClass || options.NOT_AVAILABLE;
        };
        var getNavigatorPlatform = function(options) {
          if (navigator.platform) {
            return navigator.platform;
          } else {
            return options.NOT_AVAILABLE;
          }
        };
        var getDoNotTrack = function(options) {
          if (navigator.doNotTrack) {
            return navigator.doNotTrack;
          } else if (navigator.msDoNotTrack) {
            return navigator.msDoNotTrack;
          } else if (window.doNotTrack) {
            return window.doNotTrack;
          } else {
            return options.NOT_AVAILABLE;
          }
        };
        var getTouchSupport = function() {
          var maxTouchPoints = 0;
          var touchEvent;
          if (typeof navigator.maxTouchPoints !== "undefined") {
            maxTouchPoints = navigator.maxTouchPoints;
          } else if (typeof navigator.msMaxTouchPoints !== "undefined") {
            maxTouchPoints = navigator.msMaxTouchPoints;
          }
          try {
            document.createEvent("TouchEvent");
            touchEvent = true;
          } catch (_) {
            touchEvent = false;
          }
          var touchStart = "ontouchstart" in window;
          return [maxTouchPoints, touchEvent, touchStart];
        };
        var getCanvasFp = function(options) {
          var result = [];
          var canvas = document.createElement("canvas");
          canvas.width = 2e3;
          canvas.height = 200;
          canvas.style.display = "inline";
          var ctx = canvas.getContext("2d");
          ctx.rect(0, 0, 10, 10);
          ctx.rect(2, 2, 6, 6);
          result.push("canvas winding:" + (ctx.isPointInPath(5, 5, "evenodd") === false ? "yes" : "no"));
          ctx.textBaseline = "alphabetic";
          ctx.fillStyle = "#f60";
          ctx.fillRect(125, 1, 62, 20);
          ctx.fillStyle = "#069";
          if (options.dontUseFakeFontInCanvas) {
            ctx.font = "11pt Arial";
          } else {
            ctx.font = "11pt no-real-font-123";
          }
          ctx.fillText("Cwm fjordbank glyphs vext quiz, \u{1F603}", 2, 15);
          ctx.fillStyle = "rgba(102, 204, 0, 0.2)";
          ctx.font = "18pt Arial";
          ctx.fillText("Cwm fjordbank glyphs vext quiz, \u{1F603}", 4, 45);
          ctx.globalCompositeOperation = "multiply";
          ctx.fillStyle = "rgb(255,0,255)";
          ctx.beginPath();
          ctx.arc(50, 50, 50, 0, Math.PI * 2, true);
          ctx.closePath();
          ctx.fill();
          ctx.fillStyle = "rgb(0,255,255)";
          ctx.beginPath();
          ctx.arc(100, 50, 50, 0, Math.PI * 2, true);
          ctx.closePath();
          ctx.fill();
          ctx.fillStyle = "rgb(255,255,0)";
          ctx.beginPath();
          ctx.arc(75, 100, 50, 0, Math.PI * 2, true);
          ctx.closePath();
          ctx.fill();
          ctx.fillStyle = "rgb(255,0,255)";
          ctx.arc(75, 75, 75, 0, Math.PI * 2, true);
          ctx.arc(75, 75, 25, 0, Math.PI * 2, true);
          ctx.fill("evenodd");
          if (canvas.toDataURL) {
            result.push("canvas fp:" + canvas.toDataURL());
          }
          return result;
        };
        var getWebglFp = function() {
          var gl;
          var fa2s = function(fa) {
            gl.clearColor(0, 0, 0, 1);
            gl.enable(gl.DEPTH_TEST);
            gl.depthFunc(gl.LEQUAL);
            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
            return "[" + fa[0] + ", " + fa[1] + "]";
          };
          var maxAnisotropy = function(gl2) {
            var ext = gl2.getExtension("EXT_texture_filter_anisotropic") || gl2.getExtension("WEBKIT_EXT_texture_filter_anisotropic") || gl2.getExtension("MOZ_EXT_texture_filter_anisotropic");
            if (ext) {
              var anisotropy = gl2.getParameter(ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT);
              if (anisotropy === 0) {
                anisotropy = 2;
              }
              return anisotropy;
            } else {
              return null;
            }
          };
          gl = getWebglCanvas();
          if (!gl) {
            return null;
          }
          var result = [];
          var vShaderTemplate = "attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}";
          var fShaderTemplate = "precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}";
          var vertexPosBuffer = gl.createBuffer();
          gl.bindBuffer(gl.ARRAY_BUFFER, vertexPosBuffer);
          var vertices = new Float32Array([-0.2, -0.9, 0, 0.4, -0.26, 0, 0, 0.732134444, 0]);
          gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);
          vertexPosBuffer.itemSize = 3;
          vertexPosBuffer.numItems = 3;
          var program = gl.createProgram();
          var vshader = gl.createShader(gl.VERTEX_SHADER);
          gl.shaderSource(vshader, vShaderTemplate);
          gl.compileShader(vshader);
          var fshader = gl.createShader(gl.FRAGMENT_SHADER);
          gl.shaderSource(fshader, fShaderTemplate);
          gl.compileShader(fshader);
          gl.attachShader(program, vshader);
          gl.attachShader(program, fshader);
          gl.linkProgram(program);
          gl.useProgram(program);
          program.vertexPosAttrib = gl.getAttribLocation(program, "attrVertex");
          program.offsetUniform = gl.getUniformLocation(program, "uniformOffset");
          gl.enableVertexAttribArray(program.vertexPosArray);
          gl.vertexAttribPointer(program.vertexPosAttrib, vertexPosBuffer.itemSize, gl.FLOAT, false, 0, 0);
          gl.uniform2f(program.offsetUniform, 1, 1);
          gl.drawArrays(gl.TRIANGLE_STRIP, 0, vertexPosBuffer.numItems);
          try {
            result.push(gl.canvas.toDataURL());
          } catch (e3) {
          }
          result.push("extensions:" + (gl.getSupportedExtensions() || []).join(";"));
          result.push("webgl aliased line width range:" + fa2s(gl.getParameter(gl.ALIASED_LINE_WIDTH_RANGE)));
          result.push("webgl aliased point size range:" + fa2s(gl.getParameter(gl.ALIASED_POINT_SIZE_RANGE)));
          result.push("webgl alpha bits:" + gl.getParameter(gl.ALPHA_BITS));
          result.push("webgl antialiasing:" + (gl.getContextAttributes().antialias ? "yes" : "no"));
          result.push("webgl blue bits:" + gl.getParameter(gl.BLUE_BITS));
          result.push("webgl depth bits:" + gl.getParameter(gl.DEPTH_BITS));
          result.push("webgl green bits:" + gl.getParameter(gl.GREEN_BITS));
          result.push("webgl max anisotropy:" + maxAnisotropy(gl));
          result.push("webgl max combined texture image units:" + gl.getParameter(gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS));
          result.push("webgl max cube map texture size:" + gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE));
          result.push("webgl max fragment uniform vectors:" + gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS));
          result.push("webgl max render buffer size:" + gl.getParameter(gl.MAX_RENDERBUFFER_SIZE));
          result.push("webgl max texture image units:" + gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS));
          result.push("webgl max texture size:" + gl.getParameter(gl.MAX_TEXTURE_SIZE));
          result.push("webgl max varying vectors:" + gl.getParameter(gl.MAX_VARYING_VECTORS));
          result.push("webgl max vertex attribs:" + gl.getParameter(gl.MAX_VERTEX_ATTRIBS));
          result.push("webgl max vertex texture image units:" + gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS));
          result.push("webgl max vertex uniform vectors:" + gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS));
          result.push("webgl max viewport dims:" + fa2s(gl.getParameter(gl.MAX_VIEWPORT_DIMS)));
          result.push("webgl red bits:" + gl.getParameter(gl.RED_BITS));
          result.push("webgl renderer:" + gl.getParameter(gl.RENDERER));
          result.push("webgl shading language version:" + gl.getParameter(gl.SHADING_LANGUAGE_VERSION));
          result.push("webgl stencil bits:" + gl.getParameter(gl.STENCIL_BITS));
          result.push("webgl vendor:" + gl.getParameter(gl.VENDOR));
          result.push("webgl version:" + gl.getParameter(gl.VERSION));
          try {
            var extensionDebugRendererInfo = gl.getExtension("WEBGL_debug_renderer_info");
            if (extensionDebugRendererInfo) {
              result.push("webgl unmasked vendor:" + gl.getParameter(extensionDebugRendererInfo.UNMASKED_VENDOR_WEBGL));
              result.push("webgl unmasked renderer:" + gl.getParameter(extensionDebugRendererInfo.UNMASKED_RENDERER_WEBGL));
            }
          } catch (e3) {
          }
          if (!gl.getShaderPrecisionFormat) {
            loseWebglContext(gl);
            return result;
          }
          each(["FLOAT", "INT"], function(numType) {
            each(["VERTEX", "FRAGMENT"], function(shader) {
              each(["HIGH", "MEDIUM", "LOW"], function(numSize) {
                each(["precision", "rangeMin", "rangeMax"], function(key) {
                  var format = gl.getShaderPrecisionFormat(gl[shader + "_SHADER"], gl[numSize + "_" + numType])[key];
                  if (key !== "precision") {
                    key = "precision " + key;
                  }
                  var line = ["webgl ", shader.toLowerCase(), " shader ", numSize.toLowerCase(), " ", numType.toLowerCase(), " ", key, ":", format].join("");
                  result.push(line);
                });
              });
            });
          });
          loseWebglContext(gl);
          return result;
        };
        var getWebglVendorAndRenderer = function() {
          try {
            var glContext = getWebglCanvas();
            var extensionDebugRendererInfo = glContext.getExtension("WEBGL_debug_renderer_info");
            var params = glContext.getParameter(extensionDebugRendererInfo.UNMASKED_VENDOR_WEBGL) + "~" + glContext.getParameter(extensionDebugRendererInfo.UNMASKED_RENDERER_WEBGL);
            loseWebglContext(glContext);
            return params;
          } catch (e3) {
            return null;
          }
        };
        var getAdBlock = function() {
          var ads = document.createElement("div");
          ads.innerHTML = "&nbsp;";
          ads.className = "adsbox";
          var result = false;
          try {
            document.body.appendChild(ads);
            result = document.getElementsByClassName("adsbox")[0].offsetHeight === 0;
            document.body.removeChild(ads);
          } catch (e3) {
            result = false;
          }
          return result;
        };
        var getHasLiedLanguages = function() {
          if (typeof navigator.languages !== "undefined") {
            try {
              var firstLanguages = navigator.languages[0].substr(0, 2);
              if (firstLanguages !== navigator.language.substr(0, 2)) {
                return true;
              }
            } catch (err2) {
              return true;
            }
          }
          return false;
        };
        var getHasLiedResolution = function() {
          return window.screen.width < window.screen.availWidth || window.screen.height < window.screen.availHeight;
        };
        var getHasLiedOs = function() {
          var userAgent = navigator.userAgent.toLowerCase();
          var oscpu = navigator.oscpu;
          var platform = navigator.platform.toLowerCase();
          var os;
          if (userAgent.indexOf("windows phone") >= 0) {
            os = "Windows Phone";
          } else if (userAgent.indexOf("windows") >= 0 || userAgent.indexOf("win16") >= 0 || userAgent.indexOf("win32") >= 0 || userAgent.indexOf("win64") >= 0 || userAgent.indexOf("win95") >= 0 || userAgent.indexOf("win98") >= 0 || userAgent.indexOf("winnt") >= 0 || userAgent.indexOf("wow64") >= 0) {
            os = "Windows";
          } else if (userAgent.indexOf("android") >= 0) {
            os = "Android";
          } else if (userAgent.indexOf("linux") >= 0 || userAgent.indexOf("cros") >= 0 || userAgent.indexOf("x11") >= 0) {
            os = "Linux";
          } else if (userAgent.indexOf("iphone") >= 0 || userAgent.indexOf("ipad") >= 0 || userAgent.indexOf("ipod") >= 0 || userAgent.indexOf("crios") >= 0 || userAgent.indexOf("fxios") >= 0) {
            os = "iOS";
          } else if (userAgent.indexOf("macintosh") >= 0 || userAgent.indexOf("mac_powerpc)") >= 0) {
            os = "Mac";
          } else {
            os = "Other";
          }
          var mobileDevice = "ontouchstart" in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;
          if (mobileDevice && os !== "Windows" && os !== "Windows Phone" && os !== "Android" && os !== "iOS" && os !== "Other" && userAgent.indexOf("cros") === -1) {
            return true;
          }
          if (typeof oscpu !== "undefined") {
            oscpu = oscpu.toLowerCase();
            if (oscpu.indexOf("win") >= 0 && os !== "Windows" && os !== "Windows Phone") {
              return true;
            } else if (oscpu.indexOf("linux") >= 0 && os !== "Linux" && os !== "Android") {
              return true;
            } else if (oscpu.indexOf("mac") >= 0 && os !== "Mac" && os !== "iOS") {
              return true;
            } else if ((oscpu.indexOf("win") === -1 && oscpu.indexOf("linux") === -1 && oscpu.indexOf("mac") === -1) !== (os === "Other")) {
              return true;
            }
          }
          if (platform.indexOf("win") >= 0 && os !== "Windows" && os !== "Windows Phone") {
            return true;
          } else if ((platform.indexOf("linux") >= 0 || platform.indexOf("android") >= 0 || platform.indexOf("pike") >= 0) && os !== "Linux" && os !== "Android") {
            return true;
          } else if ((platform.indexOf("mac") >= 0 || platform.indexOf("ipad") >= 0 || platform.indexOf("ipod") >= 0 || platform.indexOf("iphone") >= 0) && os !== "Mac" && os !== "iOS") {
            return true;
          } else if (platform.indexOf("arm") >= 0 && os === "Windows Phone") {
            return false;
          } else if (platform.indexOf("pike") >= 0 && userAgent.indexOf("opera mini") >= 0) {
            return false;
          } else {
            var platformIsOther = platform.indexOf("win") < 0 && platform.indexOf("linux") < 0 && platform.indexOf("mac") < 0 && platform.indexOf("iphone") < 0 && platform.indexOf("ipad") < 0 && platform.indexOf("ipod") < 0;
            if (platformIsOther !== (os === "Other")) {
              return true;
            }
          }
          return typeof navigator.plugins === "undefined" && os !== "Windows" && os !== "Windows Phone";
        };
        var getHasLiedBrowser = function() {
          var userAgent = navigator.userAgent.toLowerCase();
          var productSub = navigator.productSub;
          var browser;
          if (userAgent.indexOf("edge/") >= 0 || userAgent.indexOf("iemobile/") >= 0) {
            return false;
          } else if (userAgent.indexOf("opera mini") >= 0) {
            return false;
          } else if (userAgent.indexOf("firefox/") >= 0) {
            browser = "Firefox";
          } else if (userAgent.indexOf("opera/") >= 0 || userAgent.indexOf(" opr/") >= 0) {
            browser = "Opera";
          } else if (userAgent.indexOf("chrome/") >= 0) {
            browser = "Chrome";
          } else if (userAgent.indexOf("safari/") >= 0) {
            if (userAgent.indexOf("android 1.") >= 0 || userAgent.indexOf("android 2.") >= 0 || userAgent.indexOf("android 3.") >= 0 || userAgent.indexOf("android 4.") >= 0) {
              browser = "AOSP";
            } else {
              browser = "Safari";
            }
          } else if (userAgent.indexOf("trident/") >= 0) {
            browser = "Internet Explorer";
          } else {
            browser = "Other";
          }
          if ((browser === "Chrome" || browser === "Safari" || browser === "Opera") && productSub !== "20030107") {
            return true;
          }
          var tempRes = eval.toString().length;
          if (tempRes === 37 && browser !== "Safari" && browser !== "Firefox" && browser !== "Other") {
            return true;
          } else if (tempRes === 39 && browser !== "Internet Explorer" && browser !== "Other") {
            return true;
          } else if (tempRes === 33 && browser !== "Chrome" && browser !== "AOSP" && browser !== "Opera" && browser !== "Other") {
            return true;
          }
          var errFirefox;
          try {
            throw "a";
          } catch (err2) {
            try {
              err2.toSource();
              errFirefox = true;
            } catch (errOfErr) {
              errFirefox = false;
            }
          }
          return errFirefox && browser !== "Firefox" && browser !== "Other";
        };
        var isCanvasSupported = function() {
          var elem = document.createElement("canvas");
          return !!(elem.getContext && elem.getContext("2d"));
        };
        var isWebGlSupported = function() {
          if (!isCanvasSupported()) {
            return false;
          }
          var glContext = getWebglCanvas();
          var isSupported = !!window.WebGLRenderingContext && !!glContext;
          loseWebglContext(glContext);
          return isSupported;
        };
        var isIE = function() {
          if (navigator.appName === "Microsoft Internet Explorer") {
            return true;
          } else if (navigator.appName === "Netscape" && /Trident/.test(navigator.userAgent)) {
            return true;
          }
          return false;
        };
        var isIEOrOldEdge = function() {
          return ("msWriteProfilerMark" in window) + ("msLaunchUri" in navigator) + ("msSaveBlob" in navigator) >= 2;
        };
        var hasSwfObjectLoaded = function() {
          return typeof window.swfobject !== "undefined";
        };
        var hasMinFlashInstalled = function() {
          return window.swfobject.hasFlashPlayerVersion("9.0.0");
        };
        var addFlashDivNode = function(options) {
          var node = document.createElement("div");
          node.setAttribute("id", options.fonts.swfContainerId);
          document.body.appendChild(node);
        };
        var loadSwfAndDetectFonts = function(done, options) {
          var hiddenCallback = "___fp_swf_loaded";
          window[hiddenCallback] = function(fonts) {
            done(fonts);
          };
          var id = options.fonts.swfContainerId;
          addFlashDivNode();
          var flashvars = { onReady: hiddenCallback };
          var flashparams = { allowScriptAccess: "always", menu: "false" };
          window.swfobject.embedSWF(options.fonts.swfPath, id, "1", "1", "9.0.0", false, flashvars, flashparams, {});
        };
        var getWebglCanvas = function() {
          var canvas = document.createElement("canvas");
          var gl = null;
          try {
            gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
          } catch (e3) {
          }
          if (!gl) {
            gl = null;
          }
          return gl;
        };
        var loseWebglContext = function(context) {
          var loseContextExtension = context.getExtension("WEBGL_lose_context");
          if (loseContextExtension != null) {
            loseContextExtension.loseContext();
          }
        };
        var components = [
          { key: "userAgent", getData: UserAgent },
          { key: "webdriver", getData: webdriver },
          { key: "language", getData: languageKey },
          { key: "colorDepth", getData: colorDepthKey },
          { key: "deviceMemory", getData: deviceMemoryKey },
          { key: "pixelRatio", getData: pixelRatioKey },
          { key: "hardwareConcurrency", getData: hardwareConcurrencyKey },
          { key: "screenResolution", getData: screenResolutionKey },
          { key: "availableScreenResolution", getData: availableScreenResolutionKey },
          { key: "timezoneOffset", getData: timezoneOffset },
          { key: "timezone", getData: timezone },
          { key: "sessionStorage", getData: sessionStorageKey },
          { key: "localStorage", getData: localStorageKey },
          { key: "indexedDb", getData: indexedDbKey },
          { key: "addBehavior", getData: addBehaviorKey },
          { key: "openDatabase", getData: openDatabaseKey },
          { key: "cpuClass", getData: cpuClassKey },
          { key: "platform", getData: platformKey },
          { key: "doNotTrack", getData: doNotTrackKey },
          { key: "plugins", getData: pluginsComponent },
          { key: "canvas", getData: canvasKey },
          { key: "webgl", getData: webglKey },
          { key: "webglVendorAndRenderer", getData: webglVendorAndRendererKey },
          { key: "adBlock", getData: adBlockKey },
          { key: "hasLiedLanguages", getData: hasLiedLanguagesKey },
          { key: "hasLiedResolution", getData: hasLiedResolutionKey },
          { key: "hasLiedOs", getData: hasLiedOsKey },
          { key: "hasLiedBrowser", getData: hasLiedBrowserKey },
          { key: "touchSupport", getData: touchSupportKey },
          { key: "fonts", getData: jsFontsKey, pauseBefore: true },
          { key: "fontsFlash", getData: flashFontsKey, pauseBefore: true },
          { key: "audio", getData: audioKey },
          { key: "enumerateDevices", getData: enumerateDevicesKey }
        ];
        var Fingerprint2 = function(options) {
          throw new Error("'new Fingerprint()' is deprecated, see https://github.com/fingerprintjs/fingerprintjs#upgrade-guide-from-182-to-200");
        };
        Fingerprint2.get = function(options, callback) {
          if (!callback) {
            callback = options;
            options = {};
          } else if (!options) {
            options = {};
          }
          extendSoft(options, defaultOptions);
          options.components = options.extraComponents.concat(components);
          var keys = {
            data: [],
            addPreprocessedComponent: function(key, value) {
              if (typeof options.preprocessor === "function") {
                value = options.preprocessor(key, value);
              }
              keys.data.push({ key, value });
            }
          };
          var i = -1;
          var chainComponents = function(alreadyWaited) {
            i += 1;
            if (i >= options.components.length) {
              callback(keys.data);
              return;
            }
            var component = options.components[i];
            if (options.excludes[component.key]) {
              chainComponents(false);
              return;
            }
            if (!alreadyWaited && component.pauseBefore) {
              i -= 1;
              setTimeout(function() {
                chainComponents(true);
              }, 1);
              return;
            }
            try {
              component.getData(function(value) {
                keys.addPreprocessedComponent(component.key, value);
                chainComponents(false);
              }, options);
            } catch (error2) {
              keys.addPreprocessedComponent(component.key, String(error2));
              chainComponents(false);
            }
          };
          chainComponents(false);
        };
        Fingerprint2.getPromise = function(options) {
          return new Promise(function(resolve, reject) {
            Fingerprint2.get(options, resolve);
          });
        };
        Fingerprint2.getV18 = function(options, callback) {
          if (callback == null) {
            callback = options;
            options = {};
          }
          return Fingerprint2.get(options, function(components2) {
            var newComponents = [];
            for (var i = 0; i < components2.length; i++) {
              var component = components2[i];
              if (component.value === (options.NOT_AVAILABLE || "not available")) {
                newComponents.push({ key: component.key, value: "unknown" });
              } else if (component.key === "plugins") {
                newComponents.push({
                  key: "plugins",
                  value: map(component.value, function(p) {
                    var mimeTypes = map(p[2], function(mt) {
                      if (mt.join) {
                        return mt.join("~");
                      }
                      return mt;
                    }).join(",");
                    return [p[0], p[1], mimeTypes].join("::");
                  })
                });
              } else if (["canvas", "webgl"].indexOf(component.key) !== -1 && Array.isArray(component.value)) {
                newComponents.push({ key: component.key, value: component.value.join("~") });
              } else if (["sessionStorage", "localStorage", "indexedDb", "addBehavior", "openDatabase"].indexOf(component.key) !== -1) {
                if (component.value) {
                  newComponents.push({ key: component.key, value: 1 });
                } else {
                  continue;
                }
              } else {
                if (component.value) {
                  newComponents.push(component.value.join ? { key: component.key, value: component.value.join(";") } : component);
                } else {
                  newComponents.push({ key: component.key, value: component.value });
                }
              }
            }
            var murmur = x64hash128(map(newComponents, function(component2) {
              return component2.value;
            }).join("~~~"), 31);
            callback(murmur, newComponents);
          });
        };
        Fingerprint2.x64hash128 = x64hash128;
        Fingerprint2.VERSION = "2.1.4";
        return Fingerprint2;
      });
    }
  });

  // node_modules/lodash.defaultsdeep/index.js
  var require_lodash = __commonJS({
    "node_modules/lodash.defaultsdeep/index.js"(exports, module) {
      var LARGE_ARRAY_SIZE = 200;
      var HASH_UNDEFINED = "__lodash_hash_undefined__";
      var HOT_COUNT = 800;
      var HOT_SPAN = 16;
      var MAX_SAFE_INTEGER = 9007199254740991;
      var argsTag = "[object Arguments]";
      var arrayTag = "[object Array]";
      var asyncTag = "[object AsyncFunction]";
      var boolTag = "[object Boolean]";
      var dateTag = "[object Date]";
      var errorTag = "[object Error]";
      var funcTag = "[object Function]";
      var genTag = "[object GeneratorFunction]";
      var mapTag = "[object Map]";
      var numberTag = "[object Number]";
      var nullTag = "[object Null]";
      var objectTag = "[object Object]";
      var proxyTag = "[object Proxy]";
      var regexpTag = "[object RegExp]";
      var setTag = "[object Set]";
      var stringTag = "[object String]";
      var undefinedTag = "[object Undefined]";
      var weakMapTag = "[object WeakMap]";
      var arrayBufferTag = "[object ArrayBuffer]";
      var dataViewTag = "[object DataView]";
      var float32Tag = "[object Float32Array]";
      var float64Tag = "[object Float64Array]";
      var int8Tag = "[object Int8Array]";
      var int16Tag = "[object Int16Array]";
      var int32Tag = "[object Int32Array]";
      var uint8Tag = "[object Uint8Array]";
      var uint8ClampedTag = "[object Uint8ClampedArray]";
      var uint16Tag = "[object Uint16Array]";
      var uint32Tag = "[object Uint32Array]";
      var reRegExpChar = /[\\^$.*+?()[\]{}|]/g;
      var reIsHostCtor = /^\[object .+?Constructor\]$/;
      var reIsUint = /^(?:0|[1-9]\d*)$/;
      var typedArrayTags = {};
      typedArrayTags[float32Tag] = typedArrayTags[float64Tag] = typedArrayTags[int8Tag] = typedArrayTags[int16Tag] = typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] = typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] = typedArrayTags[uint32Tag] = true;
      typedArrayTags[argsTag] = typedArrayTags[arrayTag] = typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] = typedArrayTags[dataViewTag] = typedArrayTags[dateTag] = typedArrayTags[errorTag] = typedArrayTags[funcTag] = typedArrayTags[mapTag] = typedArrayTags[numberTag] = typedArrayTags[objectTag] = typedArrayTags[regexpTag] = typedArrayTags[setTag] = typedArrayTags[stringTag] = typedArrayTags[weakMapTag] = false;
      var freeGlobal = typeof global == "object" && global && global.Object === Object && global;
      var freeSelf = typeof self == "object" && self && self.Object === Object && self;
      var root = freeGlobal || freeSelf || Function("return this")();
      var freeExports = typeof exports == "object" && exports && !exports.nodeType && exports;
      var freeModule = freeExports && typeof module == "object" && module && !module.nodeType && module;
      var moduleExports = freeModule && freeModule.exports === freeExports;
      var freeProcess = moduleExports && freeGlobal.process;
      var nodeUtil = function() {
        try {
          var types = freeModule && freeModule.require && freeModule.require("util").types;
          if (types) {
            return types;
          }
          return freeProcess && freeProcess.binding && freeProcess.binding("util");
        } catch (e3) {
        }
      }();
      var nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;
      function apply(func, thisArg, args) {
        switch (args.length) {
          case 0:
            return func.call(thisArg);
          case 1:
            return func.call(thisArg, args[0]);
          case 2:
            return func.call(thisArg, args[0], args[1]);
          case 3:
            return func.call(thisArg, args[0], args[1], args[2]);
        }
        return func.apply(thisArg, args);
      }
      function baseTimes(n2, iteratee) {
        var index = -1, result = Array(n2);
        while (++index < n2) {
          result[index] = iteratee(index);
        }
        return result;
      }
      function baseUnary(func) {
        return function(value) {
          return func(value);
        };
      }
      function getValue(object, key) {
        return object == null ? void 0 : object[key];
      }
      function overArg(func, transform) {
        return function(arg) {
          return func(transform(arg));
        };
      }
      var arrayProto = Array.prototype;
      var funcProto = Function.prototype;
      var objectProto = Object.prototype;
      var coreJsData = root["__core-js_shared__"];
      var funcToString = funcProto.toString;
      var hasOwnProperty = objectProto.hasOwnProperty;
      var maskSrcKey = function() {
        var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || "");
        return uid ? "Symbol(src)_1." + uid : "";
      }();
      var nativeObjectToString = objectProto.toString;
      var objectCtorString = funcToString.call(Object);
      var reIsNative = RegExp("^" + funcToString.call(hasOwnProperty).replace(reRegExpChar, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$");
      var Buffer2 = moduleExports ? root.Buffer : void 0;
      var Symbol = root.Symbol;
      var Uint8Array2 = root.Uint8Array;
      var allocUnsafe = Buffer2 ? Buffer2.allocUnsafe : void 0;
      var getPrototype = overArg(Object.getPrototypeOf, Object);
      var objectCreate = Object.create;
      var propertyIsEnumerable = objectProto.propertyIsEnumerable;
      var splice = arrayProto.splice;
      var symToStringTag = Symbol ? Symbol.toStringTag : void 0;
      var defineProperty = function() {
        try {
          var func = getNative(Object, "defineProperty");
          func({}, "", {});
          return func;
        } catch (e3) {
        }
      }();
      var nativeIsBuffer = Buffer2 ? Buffer2.isBuffer : void 0;
      var nativeMax = Math.max;
      var nativeNow = Date.now;
      var Map = getNative(root, "Map");
      var nativeCreate = getNative(Object, "create");
      var baseCreate = function() {
        function object() {
        }
        return function(proto) {
          if (!isObject(proto)) {
            return {};
          }
          if (objectCreate) {
            return objectCreate(proto);
          }
          object.prototype = proto;
          var result = new object();
          object.prototype = void 0;
          return result;
        };
      }();
      function Hash(entries) {
        var index = -1, length = entries == null ? 0 : entries.length;
        this.clear();
        while (++index < length) {
          var entry = entries[index];
          this.set(entry[0], entry[1]);
        }
      }
      function hashClear() {
        this.__data__ = nativeCreate ? nativeCreate(null) : {};
        this.size = 0;
      }
      function hashDelete(key) {
        var result = this.has(key) && delete this.__data__[key];
        this.size -= result ? 1 : 0;
        return result;
      }
      function hashGet(key) {
        var data = this.__data__;
        if (nativeCreate) {
          var result = data[key];
          return result === HASH_UNDEFINED ? void 0 : result;
        }
        return hasOwnProperty.call(data, key) ? data[key] : void 0;
      }
      function hashHas(key) {
        var data = this.__data__;
        return nativeCreate ? data[key] !== void 0 : hasOwnProperty.call(data, key);
      }
      function hashSet(key, value) {
        var data = this.__data__;
        this.size += this.has(key) ? 0 : 1;
        data[key] = nativeCreate && value === void 0 ? HASH_UNDEFINED : value;
        return this;
      }
      Hash.prototype.clear = hashClear;
      Hash.prototype["delete"] = hashDelete;
      Hash.prototype.get = hashGet;
      Hash.prototype.has = hashHas;
      Hash.prototype.set = hashSet;
      function ListCache(entries) {
        var index = -1, length = entries == null ? 0 : entries.length;
        this.clear();
        while (++index < length) {
          var entry = entries[index];
          this.set(entry[0], entry[1]);
        }
      }
      function listCacheClear() {
        this.__data__ = [];
        this.size = 0;
      }
      function listCacheDelete(key) {
        var data = this.__data__, index = assocIndexOf(data, key);
        if (index < 0) {
          return false;
        }
        var lastIndex = data.length - 1;
        if (index == lastIndex) {
          data.pop();
        } else {
          splice.call(data, index, 1);
        }
        --this.size;
        return true;
      }
      function listCacheGet(key) {
        var data = this.__data__, index = assocIndexOf(data, key);
        return index < 0 ? void 0 : data[index][1];
      }
      function listCacheHas(key) {
        return assocIndexOf(this.__data__, key) > -1;
      }
      function listCacheSet(key, value) {
        var data = this.__data__, index = assocIndexOf(data, key);
        if (index < 0) {
          ++this.size;
          data.push([key, value]);
        } else {
          data[index][1] = value;
        }
        return this;
      }
      ListCache.prototype.clear = listCacheClear;
      ListCache.prototype["delete"] = listCacheDelete;
      ListCache.prototype.get = listCacheGet;
      ListCache.prototype.has = listCacheHas;
      ListCache.prototype.set = listCacheSet;
      function MapCache(entries) {
        var index = -1, length = entries == null ? 0 : entries.length;
        this.clear();
        while (++index < length) {
          var entry = entries[index];
          this.set(entry[0], entry[1]);
        }
      }
      function mapCacheClear() {
        this.size = 0;
        this.__data__ = {
          "hash": new Hash(),
          "map": new (Map || ListCache)(),
          "string": new Hash()
        };
      }
      function mapCacheDelete(key) {
        var result = getMapData(this, key)["delete"](key);
        this.size -= result ? 1 : 0;
        return result;
      }
      function mapCacheGet(key) {
        return getMapData(this, key).get(key);
      }
      function mapCacheHas(key) {
        return getMapData(this, key).has(key);
      }
      function mapCacheSet(key, value) {
        var data = getMapData(this, key), size = data.size;
        data.set(key, value);
        this.size += data.size == size ? 0 : 1;
        return this;
      }
      MapCache.prototype.clear = mapCacheClear;
      MapCache.prototype["delete"] = mapCacheDelete;
      MapCache.prototype.get = mapCacheGet;
      MapCache.prototype.has = mapCacheHas;
      MapCache.prototype.set = mapCacheSet;
      function Stack(entries) {
        var data = this.__data__ = new ListCache(entries);
        this.size = data.size;
      }
      function stackClear() {
        this.__data__ = new ListCache();
        this.size = 0;
      }
      function stackDelete(key) {
        var data = this.__data__, result = data["delete"](key);
        this.size = data.size;
        return result;
      }
      function stackGet(key) {
        return this.__data__.get(key);
      }
      function stackHas(key) {
        return this.__data__.has(key);
      }
      function stackSet(key, value) {
        var data = this.__data__;
        if (data instanceof ListCache) {
          var pairs = data.__data__;
          if (!Map || pairs.length < LARGE_ARRAY_SIZE - 1) {
            pairs.push([key, value]);
            this.size = ++data.size;
            return this;
          }
          data = this.__data__ = new MapCache(pairs);
        }
        data.set(key, value);
        this.size = data.size;
        return this;
      }
      Stack.prototype.clear = stackClear;
      Stack.prototype["delete"] = stackDelete;
      Stack.prototype.get = stackGet;
      Stack.prototype.has = stackHas;
      Stack.prototype.set = stackSet;
      function arrayLikeKeys(value, inherited) {
        var isArr = isArray(value), isArg = !isArr && isArguments(value), isBuff = !isArr && !isArg && isBuffer(value), isType = !isArr && !isArg && !isBuff && isTypedArray(value), skipIndexes = isArr || isArg || isBuff || isType, result = skipIndexes ? baseTimes(value.length, String) : [], length = result.length;
        for (var key in value) {
          if ((inherited || hasOwnProperty.call(value, key)) && !(skipIndexes && (key == "length" || isBuff && (key == "offset" || key == "parent") || isType && (key == "buffer" || key == "byteLength" || key == "byteOffset") || isIndex(key, length)))) {
            result.push(key);
          }
        }
        return result;
      }
      function assignMergeValue(object, key, value) {
        if (value !== void 0 && !eq(object[key], value) || value === void 0 && !(key in object)) {
          baseAssignValue(object, key, value);
        }
      }
      function assignValue(object, key, value) {
        var objValue = object[key];
        if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) || value === void 0 && !(key in object)) {
          baseAssignValue(object, key, value);
        }
      }
      function assocIndexOf(array, key) {
        var length = array.length;
        while (length--) {
          if (eq(array[length][0], key)) {
            return length;
          }
        }
        return -1;
      }
      function baseAssignValue(object, key, value) {
        if (key == "__proto__" && defineProperty) {
          defineProperty(object, key, {
            "configurable": true,
            "enumerable": true,
            "value": value,
            "writable": true
          });
        } else {
          object[key] = value;
        }
      }
      var baseFor = createBaseFor();
      function baseGetTag(value) {
        if (value == null) {
          return value === void 0 ? undefinedTag : nullTag;
        }
        return symToStringTag && symToStringTag in Object(value) ? getRawTag(value) : objectToString(value);
      }
      function baseIsArguments(value) {
        return isObjectLike(value) && baseGetTag(value) == argsTag;
      }
      function baseIsNative(value) {
        if (!isObject(value) || isMasked(value)) {
          return false;
        }
        var pattern = isFunction(value) ? reIsNative : reIsHostCtor;
        return pattern.test(toSource(value));
      }
      function baseIsTypedArray(value) {
        return isObjectLike(value) && isLength(value.length) && !!typedArrayTags[baseGetTag(value)];
      }
      function baseKeysIn(object) {
        if (!isObject(object)) {
          return nativeKeysIn(object);
        }
        var isProto = isPrototype(object), result = [];
        for (var key in object) {
          if (!(key == "constructor" && (isProto || !hasOwnProperty.call(object, key)))) {
            result.push(key);
          }
        }
        return result;
      }
      function baseMerge(object, source, srcIndex, customizer, stack) {
        if (object === source) {
          return;
        }
        baseFor(source, function(srcValue, key) {
          stack || (stack = new Stack());
          if (isObject(srcValue)) {
            baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);
          } else {
            var newValue = customizer ? customizer(safeGet(object, key), srcValue, key + "", object, source, stack) : void 0;
            if (newValue === void 0) {
              newValue = srcValue;
            }
            assignMergeValue(object, key, newValue);
          }
        }, keysIn);
      }
      function baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {
        var objValue = safeGet(object, key), srcValue = safeGet(source, key), stacked = stack.get(srcValue);
        if (stacked) {
          assignMergeValue(object, key, stacked);
          return;
        }
        var newValue = customizer ? customizer(objValue, srcValue, key + "", object, source, stack) : void 0;
        var isCommon = newValue === void 0;
        if (isCommon) {
          var isArr = isArray(srcValue), isBuff = !isArr && isBuffer(srcValue), isTyped = !isArr && !isBuff && isTypedArray(srcValue);
          newValue = srcValue;
          if (isArr || isBuff || isTyped) {
            if (isArray(objValue)) {
              newValue = objValue;
            } else if (isArrayLikeObject(objValue)) {
              newValue = copyArray(objValue);
            } else if (isBuff) {
              isCommon = false;
              newValue = cloneBuffer(srcValue, true);
            } else if (isTyped) {
              isCommon = false;
              newValue = cloneTypedArray(srcValue, true);
            } else {
              newValue = [];
            }
          } else if (isPlainObject(srcValue) || isArguments(srcValue)) {
            newValue = objValue;
            if (isArguments(objValue)) {
              newValue = toPlainObject(objValue);
            } else if (!isObject(objValue) || isFunction(objValue)) {
              newValue = initCloneObject(srcValue);
            }
          } else {
            isCommon = false;
          }
        }
        if (isCommon) {
          stack.set(srcValue, newValue);
          mergeFunc(newValue, srcValue, srcIndex, customizer, stack);
          stack["delete"](srcValue);
        }
        assignMergeValue(object, key, newValue);
      }
      function baseRest(func, start) {
        return setToString(overRest(func, start, identity), func + "");
      }
      var baseSetToString = !defineProperty ? identity : function(func, string) {
        return defineProperty(func, "toString", {
          "configurable": true,
          "enumerable": false,
          "value": constant(string),
          "writable": true
        });
      };
      function cloneBuffer(buffer, isDeep) {
        if (isDeep) {
          return buffer.slice();
        }
        var length = buffer.length, result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);
        buffer.copy(result);
        return result;
      }
      function cloneArrayBuffer(arrayBuffer) {
        var result = new arrayBuffer.constructor(arrayBuffer.byteLength);
        new Uint8Array2(result).set(new Uint8Array2(arrayBuffer));
        return result;
      }
      function cloneTypedArray(typedArray, isDeep) {
        var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;
        return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);
      }
      function copyArray(source, array) {
        var index = -1, length = source.length;
        array || (array = Array(length));
        while (++index < length) {
          array[index] = source[index];
        }
        return array;
      }
      function copyObject(source, props, object, customizer) {
        var isNew = !object;
        object || (object = {});
        var index = -1, length = props.length;
        while (++index < length) {
          var key = props[index];
          var newValue = customizer ? customizer(object[key], source[key], key, object, source) : void 0;
          if (newValue === void 0) {
            newValue = source[key];
          }
          if (isNew) {
            baseAssignValue(object, key, newValue);
          } else {
            assignValue(object, key, newValue);
          }
        }
        return object;
      }
      function createAssigner(assigner) {
        return baseRest(function(object, sources) {
          var index = -1, length = sources.length, customizer = length > 1 ? sources[length - 1] : void 0, guard = length > 2 ? sources[2] : void 0;
          customizer = assigner.length > 3 && typeof customizer == "function" ? (length--, customizer) : void 0;
          if (guard && isIterateeCall(sources[0], sources[1], guard)) {
            customizer = length < 3 ? void 0 : customizer;
            length = 1;
          }
          object = Object(object);
          while (++index < length) {
            var source = sources[index];
            if (source) {
              assigner(object, source, index, customizer);
            }
          }
          return object;
        });
      }
      function createBaseFor(fromRight) {
        return function(object, iteratee, keysFunc) {
          var index = -1, iterable = Object(object), props = keysFunc(object), length = props.length;
          while (length--) {
            var key = props[fromRight ? length : ++index];
            if (iteratee(iterable[key], key, iterable) === false) {
              break;
            }
          }
          return object;
        };
      }
      function customDefaultsMerge(objValue, srcValue, key, object, source, stack) {
        if (isObject(objValue) && isObject(srcValue)) {
          stack.set(srcValue, objValue);
          baseMerge(objValue, srcValue, void 0, customDefaultsMerge, stack);
          stack["delete"](srcValue);
        }
        return objValue;
      }
      function getMapData(map, key) {
        var data = map.__data__;
        return isKeyable(key) ? data[typeof key == "string" ? "string" : "hash"] : data.map;
      }
      function getNative(object, key) {
        var value = getValue(object, key);
        return baseIsNative(value) ? value : void 0;
      }
      function getRawTag(value) {
        var isOwn = hasOwnProperty.call(value, symToStringTag), tag = value[symToStringTag];
        try {
          value[symToStringTag] = void 0;
          var unmasked = true;
        } catch (e3) {
        }
        var result = nativeObjectToString.call(value);
        if (unmasked) {
          if (isOwn) {
            value[symToStringTag] = tag;
          } else {
            delete value[symToStringTag];
          }
        }
        return result;
      }
      function initCloneObject(object) {
        return typeof object.constructor == "function" && !isPrototype(object) ? baseCreate(getPrototype(object)) : {};
      }
      function isIndex(value, length) {
        var type = typeof value;
        length = length == null ? MAX_SAFE_INTEGER : length;
        return !!length && (type == "number" || type != "symbol" && reIsUint.test(value)) && (value > -1 && value % 1 == 0 && value < length);
      }
      function isIterateeCall(value, index, object) {
        if (!isObject(object)) {
          return false;
        }
        var type = typeof index;
        if (type == "number" ? isArrayLike(object) && isIndex(index, object.length) : type == "string" && index in object) {
          return eq(object[index], value);
        }
        return false;
      }
      function isKeyable(value) {
        var type = typeof value;
        return type == "string" || type == "number" || type == "symbol" || type == "boolean" ? value !== "__proto__" : value === null;
      }
      function isMasked(func) {
        return !!maskSrcKey && maskSrcKey in func;
      }
      function isPrototype(value) {
        var Ctor = value && value.constructor, proto = typeof Ctor == "function" && Ctor.prototype || objectProto;
        return value === proto;
      }
      function nativeKeysIn(object) {
        var result = [];
        if (object != null) {
          for (var key in Object(object)) {
            result.push(key);
          }
        }
        return result;
      }
      function objectToString(value) {
        return nativeObjectToString.call(value);
      }
      function overRest(func, start, transform) {
        start = nativeMax(start === void 0 ? func.length - 1 : start, 0);
        return function() {
          var args = arguments, index = -1, length = nativeMax(args.length - start, 0), array = Array(length);
          while (++index < length) {
            array[index] = args[start + index];
          }
          index = -1;
          var otherArgs = Array(start + 1);
          while (++index < start) {
            otherArgs[index] = args[index];
          }
          otherArgs[start] = transform(array);
          return apply(func, this, otherArgs);
        };
      }
      function safeGet(object, key) {
        if (key === "constructor" && typeof object[key] === "function") {
          return;
        }
        if (key == "__proto__") {
          return;
        }
        return object[key];
      }
      var setToString = shortOut(baseSetToString);
      function shortOut(func) {
        var count = 0, lastCalled = 0;
        return function() {
          var stamp = nativeNow(), remaining = HOT_SPAN - (stamp - lastCalled);
          lastCalled = stamp;
          if (remaining > 0) {
            if (++count >= HOT_COUNT) {
              return arguments[0];
            }
          } else {
            count = 0;
          }
          return func.apply(void 0, arguments);
        };
      }
      function toSource(func) {
        if (func != null) {
          try {
            return funcToString.call(func);
          } catch (e3) {
          }
          try {
            return func + "";
          } catch (e3) {
          }
        }
        return "";
      }
      function eq(value, other) {
        return value === other || value !== value && other !== other;
      }
      var isArguments = baseIsArguments(function() {
        return arguments;
      }()) ? baseIsArguments : function(value) {
        return isObjectLike(value) && hasOwnProperty.call(value, "callee") && !propertyIsEnumerable.call(value, "callee");
      };
      var isArray = Array.isArray;
      function isArrayLike(value) {
        return value != null && isLength(value.length) && !isFunction(value);
      }
      function isArrayLikeObject(value) {
        return isObjectLike(value) && isArrayLike(value);
      }
      var isBuffer = nativeIsBuffer || stubFalse;
      function isFunction(value) {
        if (!isObject(value)) {
          return false;
        }
        var tag = baseGetTag(value);
        return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;
      }
      function isLength(value) {
        return typeof value == "number" && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
      }
      function isObject(value) {
        var type = typeof value;
        return value != null && (type == "object" || type == "function");
      }
      function isObjectLike(value) {
        return value != null && typeof value == "object";
      }
      function isPlainObject(value) {
        if (!isObjectLike(value) || baseGetTag(value) != objectTag) {
          return false;
        }
        var proto = getPrototype(value);
        if (proto === null) {
          return true;
        }
        var Ctor = hasOwnProperty.call(proto, "constructor") && proto.constructor;
        return typeof Ctor == "function" && Ctor instanceof Ctor && funcToString.call(Ctor) == objectCtorString;
      }
      var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;
      function toPlainObject(value) {
        return copyObject(value, keysIn(value));
      }
      var defaultsDeep = baseRest(function(args) {
        args.push(void 0, customDefaultsMerge);
        return apply(mergeWith, void 0, args);
      });
      function keysIn(object) {
        return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);
      }
      var mergeWith = createAssigner(function(object, source, srcIndex, customizer) {
        baseMerge(object, source, srcIndex, customizer);
      });
      function constant(value) {
        return function() {
          return value;
        };
      }
      function identity(value) {
        return value;
      }
      function stubFalse() {
        return false;
      }
      module.exports = defaultsDeep;
    }
  });

  // node_modules/redaxios/dist/redaxios.module.js
  var redaxios_module_default = function e(t2) {
    function r2(e3, t3, n3) {
      var a, o = {};
      if (Array.isArray(e3))
        return e3.concat(t3);
      for (a in e3)
        o[n3 ? a.toLowerCase() : a] = e3[a];
      for (a in t3) {
        var i = n3 ? a.toLowerCase() : a, u = t3[a];
        o[i] = i in o && typeof u == "object" ? r2(o[i], u, i === "headers") : u;
      }
      return o;
    }
    function n2(e3, n3, a, o) {
      typeof e3 != "string" && (e3 = (n3 = e3).url);
      var i = { config: n3 }, u = r2(t2, n3), s = {}, c = o || u.data;
      (u.transformRequest || []).map(function(e4) {
        c = e4(c, u.headers) || c;
      }), c && typeof c == "object" && typeof c.append != "function" && (c = JSON.stringify(c), s["content-type"] = "application/json");
      var f = typeof document != "undefined" && document.cookie.match(RegExp("(^|; )" + u.xsrfCookieName + "=([^;]*)"));
      if (f && (s[u.xsrfHeaderName] = f[2]), u.auth && (s.authorization = u.auth), u.baseURL && (e3 = e3.replace(/^(?!.*\/\/)\/?(.*)$/, u.baseURL + "/$1")), u.params) {
        var p = ~e3.indexOf("?") ? "&" : "?";
        e3 += p + (u.paramsSerializer ? u.paramsSerializer(u.params) : new URLSearchParams(u.params));
      }
      return (u.fetch || fetch)(e3, { method: a || u.method, body: c, headers: r2(u.headers, s, true), credentials: u.withCredentials ? "include" : "same-origin" }).then(function(e4) {
        for (var t3 in e4)
          typeof e4[t3] != "function" && (i[t3] = e4[t3]);
        var r3 = u.validateStatus ? u.validateStatus(e4.status) : e4.ok;
        return u.responseType == "stream" ? (i.data = e4.body, i) : e4[u.responseType || "text"]().then(function(e5) {
          i.data = e5, i.data = JSON.parse(e5);
        }).catch(Object).then(function() {
          return r3 ? i : Promise.reject(i);
        });
      });
    }
    return t2 = t2 || {}, n2.request = n2, n2.get = function(e3, t3) {
      return n2(e3, t3, "get");
    }, n2.delete = function(e3, t3) {
      return n2(e3, t3, "delete");
    }, n2.head = function(e3, t3) {
      return n2(e3, t3, "head");
    }, n2.options = function(e3, t3) {
      return n2(e3, t3, "options");
    }, n2.post = function(e3, t3, r3) {
      return n2(e3, r3, "post", t3);
    }, n2.put = function(e3, t3, r3) {
      return n2(e3, r3, "put", t3);
    }, n2.patch = function(e3, t3, r3) {
      return n2(e3, r3, "patch", t3);
    }, n2.all = Promise.all.bind(Promise), n2.spread = function(e3) {
      return function(t3) {
        return e3.apply(this, t3);
      };
    }, n2.CancelToken = typeof AbortController == "function" ? AbortController : Object, n2.defaults = t2, n2.create = e, n2;
  }();

  // app/javascript/script/api.js
  var setup = (config) => {
    redaxios_module_default.defaults.baseURL = `${config.script_url}/${config.uuid}`;
  };
  var formData = (data) => {
    const form = new FormData();
    Object.keys(data).forEach((key) => {
      if (data[key]) {
        form.append(key, data[key]);
      }
    });
    return form;
  };
  var markVerified = (data) => {
    const form = formData(data);
    return redaxios_module_default.post(`/campaigns/${data.campaign_id}/verify_script`, form).then((resp) => resp.data);
  };
  var testReferral = (data) => {
    return redaxios_module_default.post(`/campaigns/${data.campaign_id}/test_referral`, data).then((resp) => resp.data);
  };
  var subscribe = (data, opts = { ajax: false }) => {
    const form = formData(data);
    if (!opts.ajax && typeof navigator.sendBeacon == "function") {
      navigator.sendBeacon(`${redaxios_module_default.defaults.baseURL}/add_subscriber`, form);
      return Promise.resolve(true);
    } else {
      return redaxios_module_default.post(`/add_subscriber`, form).then((resp) => {
        return Promise.resolve(resp.data);
      });
    }
  };
  var upscribe = (data) => {
    const form = formData(data);
    if (typeof navigator.sendBeacon == "function") {
      navigator.sendBeacon(`${redaxios_module_default.defaults.baseURL}/upscribe`, form);
      return Promise.resolve(true);
    } else {
      return redaxios_module_default.post(`/upscribe`, form).then((resp) => {
        return Promise.resolve(resp.data);
      });
    }
  };
  var verifyReferrer = (data) => {
    return redaxios_module_default.post(`/check_referral_code`, data).then((resp) => {
      return Promise.resolve(resp.data);
    });
  };
  var verifyPartner = (data) => {
    return redaxios_module_default.post(`/check_partner_code`, data).then((resp) => {
      return Promise.resolve(resp.data);
    });
  };
  var fetchSubscriber = (subscriber, visitor) => {
    return redaxios_module_default.post(`/get_subscriber`, {
      subscriber,
      ...visitor
    }).then((resp) => {
      const { data } = resp;
      if (data.response === "error") {
        return Promise.reject(data.message);
      } else {
        return Promise.resolve(data.subscriber);
      }
    });
  };
  var upsertSubscriber = (subscriber, visitor) => {
    return redaxios_module_default.post(`/upsert_subscriber`, {
      subscriber,
      ...visitor
    }).then((resp) => {
      const { data } = resp;
      if (data.response === "error") {
        return Promise.reject(data.message);
      } else {
        return Promise.resolve(data.subscriber);
      }
    });
  };
  var sendEmailInvitation = (data) => {
    const form = formData(data);
    return redaxios_module_default.post(`/campaigns/${data.campaign_id}/send_email_invite`, form).then((resp) => {
      return Promise.resolve(resp.data);
    }).catch(() => {
      return Promise.reject();
    });
  };

  // app/javascript/script/flash.js
  var create = (header, body, type = "default") => {
    const item = document.createElement("li");
    item.classList.add("sl-popup-item");
    item.setAttribute("data-type", type);
    if (type != "default") {
      const icon = document.createElement("div");
      icon.classList.add("sl-popup-icon");
      icon.classList.add(`sl-popup-${type}-icon`);
      item.appendChild(icon);
    }
    const close = document.createElement("div");
    close.classList.add("sl-popup-close");
    item.appendChild(close);
    close.addEventListener("click", () => item.remove());
    const text_container = document.createElement("div");
    text_container.classList.add("sl-popup-text-container");
    const item_header = document.createElement("h3");
    item_header.innerText = header;
    text_container.appendChild(item_header);
    const item_body = document.createElement("p");
    item_body.innerHTML = body;
    text_container.appendChild(item_body);
    item.appendChild(text_container);
    if (document.getElementById("sl-popup-container")) {
      const container = document.getElementById("sl-popup-container");
      container.appendChild(item);
    } else {
      const container = document.createElement("ul");
      container.id = "sl-popup-container";
      container.appendChild(item);
      const body2 = document.getElementsByTagName("body")[0];
      body2.appendChild(container);
    }
  };
  var success = (header, body) => {
    create(header, body, "success");
  };
  var warning = (header, body) => {
    create(header, body, "warning");
  };
  var error = (header, body) => {
    create(header, body, "error");
  };
  var message = (header, body) => {
    create(header, body);
  };

  // node_modules/js-cookie/dist/js.cookie.mjs
  function assign(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];
      for (var key in source) {
        target[key] = source[key];
      }
    }
    return target;
  }
  var defaultConverter = {
    read: function(value) {
      if (value[0] === '"') {
        value = value.slice(1, -1);
      }
      return value.replace(/(%[\dA-F]{2})+/gi, decodeURIComponent);
    },
    write: function(value) {
      return encodeURIComponent(value).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g, decodeURIComponent);
    }
  };
  function init(converter, defaultAttributes) {
    function set(key, value, attributes) {
      if (typeof document === "undefined") {
        return;
      }
      attributes = assign({}, defaultAttributes, attributes);
      if (typeof attributes.expires === "number") {
        attributes.expires = new Date(Date.now() + attributes.expires * 864e5);
      }
      if (attributes.expires) {
        attributes.expires = attributes.expires.toUTCString();
      }
      key = encodeURIComponent(key).replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent).replace(/[()]/g, escape);
      var stringifiedAttributes = "";
      for (var attributeName in attributes) {
        if (!attributes[attributeName]) {
          continue;
        }
        stringifiedAttributes += "; " + attributeName;
        if (attributes[attributeName] === true) {
          continue;
        }
        stringifiedAttributes += "=" + attributes[attributeName].split(";")[0];
      }
      return document.cookie = key + "=" + converter.write(value, key) + stringifiedAttributes;
    }
    function get(key) {
      if (typeof document === "undefined" || arguments.length && !key) {
        return;
      }
      var cookies = document.cookie ? document.cookie.split("; ") : [];
      var jar = {};
      for (var i = 0; i < cookies.length; i++) {
        var parts = cookies[i].split("=");
        var value = parts.slice(1).join("=");
        try {
          var foundKey = decodeURIComponent(parts[0]);
          jar[foundKey] = converter.read(value, foundKey);
          if (key === foundKey) {
            break;
          }
        } catch (e3) {
        }
      }
      return key ? jar[key] : jar;
    }
    return Object.create({
      set,
      get,
      remove: function(key, attributes) {
        set(key, "", assign({}, attributes, {
          expires: -1
        }));
      },
      withAttributes: function(attributes) {
        return init(this.converter, assign({}, this.attributes, attributes));
      },
      withConverter: function(converter2) {
        return init(assign({}, this.converter, converter2), this.attributes);
      }
    }, {
      attributes: { value: Object.freeze(defaultAttributes) },
      converter: { value: Object.freeze(converter) }
    });
  }
  var api2 = init(defaultConverter, { path: "/" });
  var js_cookie_default = api2;

  // app/javascript/script/utils.js
  var getUrlParam = (param) => {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
  };
  var triggerEvent = (name) => {
    const event = new Event(`sl:${name}`);
    document.dispatchEvent(event);
  };
  var isVerificationMode = () => {
    return !!getUrlParam("SLVerifyInstall");
  };
  var isTestMode = () => {
    return window.SL.config.test_mode || getUrlParam("test_mode") == "true";
  };
  var isHostedReferralHubPage = () => {
    return window.location.hostname === "referralhub.page";
  };
  var globalConfig = () => {
    return window.SL.config || {};
  };
  var visitorData = (attrs = {}) => {
    let visitor = window.SL.visitor || {};
    if (Object.keys(attrs).length) {
      visitor = Object.assign(visitor, attrs);
    }
    ;
    window.SL.visitor = visitor;
    return window.SL.visitor;
  };
  var subscriberData = (attrs = null) => {
    let visitor = visitorData();
    if (attrs && Object.keys(visitor).length) {
      visitor.subscriber = attrs;
    }
    ;
    return visitor.subscriber;
  };
  var retrieveReferrerCode = () => {
    return isVerificationMode() ? getUrlParam("rh_ref") : visitorData().referrer;
  };
  var subscriberFormData = () => {
    const visitor = visitorData();
    return {
      uuid: globalConfig().uuid,
      referrer_code: retrieveReferrerCode(),
      campaign_id: visitor.campaign,
      utm_source: visitor.utm_source,
      utm_campaign: visitor.utm_campaign,
      fingerprint: visitor.fingerprint,
      email: visitor.email
    };
  };
  var showFlashMessages = () => {
    return getUrlParam("flash_messages") == "true";
  };
  var showTestModeBanner = () => {
    if (isTestMode() && showFlashMessages()) {
      message("TEST MODE ENABLED", "You're currently in test mode. No data will be stored while in test mode");
    }
  };
  var widgetsAllowed = () => {
    return window.SLConfig.plan != "lite_v3" || isTestMode() || isHostedReferralHubPage();
  };
  var storeCookie = (name, value, days = 30) => {
    if (isVerificationMode() || isTestMode()) {
      return false;
    }
    const rootDomain = window.location.hostname.replace("www.", "");
    if (value) {
      js_cookie_default.set(name, value, { expires: days, domain: `.${rootDomain}` });
      console.log(`${name} tracked`);
    }
  };
  var setDefaultCssVariables = () => {
    document.documentElement.style.setProperty("--sl-widgets-font-family", "-apple-system, system-ui");
    document.documentElement.style.setProperty("--sl-widgets-base-unit", "16px");
  };
  var loadCustomCSS = (name, custom_css) => {
    const style_id = `sparkloop-${name}-custom-css`;
    if (document.getElementById(style_id)) {
      document.getElementById(style_id).remove();
    }
    var el = document.createElement("style");
    el.type = "text/css";
    el.id = style_id;
    el.textContent = custom_css;
    document.head.appendChild(el);
  };
  var loadStylesheet = (stylesheet) => {
    const id = `sparkloop-${stylesheet}-style`;
    if (document.querySelector(`link#${id}`)) {
      return;
    }
    const el = document.createElement("link");
    el.id = id;
    el.setAttribute("rel", "stylesheet");
    el.setAttribute("href", `${window.SLConfig.app_url}/styles/${stylesheet}.css`);
    document.head.appendChild(el);
  };
  var preloadAsset = (url) => {
    const el = document.createElement("link");
    el.setAttribute("rel", "preload");
    el.setAttribute("as", "image");
    el.setAttribute("href", url);
    document.head.appendChild(el);
  };
  var copyToClipboard = (el, b, copied) => {
    let succeeded;
    if (document.body.createTextRange) {
      const textRange = document.body.createTextRange();
      textRange.moveToElementText(el);
      textRange.select();
    } else if (window.getSelection && document.createRange) {
      el.readOnly = false;
      const range = document.createRange();
      range.selectNodeContents(el);
      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
      if (el.nodeName == "TEXTAREA" || el.nodeName == "INPUT") {
        el.select();
      }
      if (el.setSelectionRange && navigator.userAgent.match(/ipad|ipod|iphone/i)) {
        el.setSelectionRange(0, 999999);
        el.readOnly = true;
      }
    }
    try {
      succeeded = document.execCommand("copy");
    } catch (n2) {
      succeeded = false;
    }
    if (succeeded) {
      const r2 = b.textContent;
      const i = copied;
      b.textContent = i;
      setTimeout(() => b.textContent = r2, 500);
      console.log("Referral link copied to clipboard.");
    }
  };
  var detectEmailInForm = (formEl) => {
    const email = formEl.querySelector("input[type*=email]") || formEl.querySelector("input[type*=Email]") || formEl.querySelector("input[name*=email]") || formEl.querySelector("input[name*=Email]") || formEl.querySelector("input[for*=email]") || formEl.querySelector("input[for*=Email]");
    return email;
  };
  var isGravityFormsWithoutEmail = (forms) => {
    let isGravityForm = false;
    let emailDetected = false;
    forms.forEach((form) => {
      if (form.querySelector(".gform_body")) {
        isGravityForm = true;
      }
      if (detectEmailInForm(form)) {
        emailDetected = true;
      }
    });
    return isGravityForm && !emailDetected;
  };
  var numberWithCommas = (x) => x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  var createElement = ({ type = "div", id = "", classes = "", text = "", html = "", parent, attributes = {} } = {}) => {
    const el = document.createElement(type);
    if (id) {
      el.id = id;
    }
    if (classes) {
      el.className = classes;
    }
    if (text) {
      el.innerText = text;
    }
    if (html) {
      el.innerHTML = html;
    }
    if (parent) {
      parent.appendChild(el);
    }
    for (const name in attributes) {
      el.setAttribute(name, attributes[name]);
    }
    return el;
  };
  var proxyComponents = () => {
    const fn = () => createElement({
      html: "<!-- Sparkloop: this plan doesn't support widgets -->"
    });
    const handler = {
      get: function() {
        return fn;
      }
    };
    return new Proxy({}, handler);
  };

  // app/javascript/script/visitor.js
  var import_fingerprintjs2 = __toESM(require_fingerprint2());
  var COOKIE_NAME_SPACE = "__sl";
  var CAMPAIGN_COOKIE = `${COOKIE_NAME_SPACE}-campaign`;
  var UTMCAMPAIGN_COOKIE = `${COOKIE_NAME_SPACE}-utm_campaign`;
  var UTMSOURCE_COOKIE = `${COOKIE_NAME_SPACE}-utm_source`;
  var FINGERPRINT_COOKIE = `${COOKIE_NAME_SPACE}-fingerprint`;
  var REFERRER_COOKIE = `${COOKIE_NAME_SPACE}-referrer`;
  var Visitor = class {
    constructor() {
      this.config = globalConfig();
      this.visitor = {};
      setup(this.config);
    }
    storeInfoCookies() {
      if (this.visitor.campaign) {
        storeCookie(`${CAMPAIGN_COOKIE}-${this.config.uuid}`, this.visitor.campaign);
      }
      if (this.visitor.utm_source) {
        storeCookie(`${UTMSOURCE_COOKIE}-${this.config.uuid}`, this.visitor.utm_source);
      }
      if (this.visitor.utm_campaign) {
        storeCookie(`${UTMCAMPAIGN_COOKIE}-${this.config.uuid}`, this.visitor.utm_campaign);
      }
    }
    fetchCampaign() {
      const cookie_campaign = js_cookie_default.get(`${REFERRER_COOKIE}-${this.config.uuid}`) ? js_cookie_default.get(`${CAMPAIGN_COOKIE}-${this.config.uuid}`) : getUrlParam("sl_campaign");
      this.visitor.campaign = cookie_campaign || getUrlParam("sl_campaign");
    }
    fetchUTMCampaign() {
      this.visitor.utm_campaign = getUrlParam("utm_campaign") || js_cookie_default.get(`${UTMCAMPAIGN_COOKIE}-${this.config.uuid}`);
    }
    fetchUTMSource() {
      const url_param = getUrlParam("utm_source") || getUrlParam("ref") || getUrlParam("source");
      const sourceCookie = js_cookie_default.get(`${UTMSOURCE_COOKIE}-${this.config.uuid}`);
      const referrer = document.referrer && new URL(document.referrer).hostname != window.location.hostname ? new URL(document.referrer).hostname.replace(/^www\./, "") : null;
      this.visitor.utm_source = url_param || referrer || sourceCookie;
    }
    async fetchAndVerifyReferrer() {
      let cookieName = `${REFERRER_COOKIE}-${this.config.uuid}`;
      const cookie = js_cookie_default.get(cookieName);
      if (cookie) {
        this.storeInfoCookies();
        this.visitor.referrer = cookie;
      }
      const referrerParam = getUrlParam("rh_ref") || getUrlParam("rh_partner");
      if (referrerParam) {
        const params = {
          uuid: this.config.uuid,
          referrer_code: referrerParam,
          campaign_id: this.visitor.campaign,
          utm_source: this.visitor.utm_source,
          utm_campaign: this.visitor.utm_campaign
        };
        let request;
        try {
          if (getUrlParam("rh_partner")) {
            request = await verifyPartner(params);
            console.log(`Partner Campaign Referral Code ${referrerParam} verified successfully`);
          } else {
            request = await verifyReferrer(params);
            console.log(`Subscriber Referral code ${referrerParam} verified successfully`);
          }
          if (request.response == "ok") {
            triggerEvent("referrer-tracked");
            storeCookie(cookieName, referrerParam);
            this.visitor.referrer = referrerParam;
            this.storeInfoCookies();
          } else {
            console.warn(request.message);
          }
        } catch (error2) {
          console.error(error2);
        }
      }
    }
    calculateFingerprint() {
      return new Promise((resolve, reject) => {
        const wrapper = window.requestIdleCallback || window.setTimeout;
        wrapper(() => {
          import_fingerprintjs2.default.get((values) => {
            const result = import_fingerprintjs2.default.x64hash128(values.join(""), 31);
            return resolve(result);
          });
        });
      });
    }
    async fetchFingerprint() {
      const cookie = js_cookie_default.get(FINGERPRINT_COOKIE);
      if (cookie) {
        this.visitor.fingerprint = cookie;
      } else {
        try {
          const fingerprint = await this.calculateFingerprint();
          storeCookie(FINGERPRINT_COOKIE, fingerprint);
          this.visitor.fingerprint = fingerprint;
        } catch (error2) {
          console.error(error2);
        }
      }
    }
    async profile() {
      this.fetchCampaign();
      this.fetchUTMSource();
      this.fetchUTMCampaign();
      await this.fetchAndVerifyReferrer();
      await this.fetchFingerprint();
      visitorData(this.visitor);
    }
  };

  // app/javascript/script/subscriber.js
  var COOKIE_NAME_SPACE2 = "__sl";
  var SUBSCRIBER_COOKIE = `${COOKIE_NAME_SPACE2}-subscriber`;
  var Subscriber = class {
    constructor() {
      this.config = globalConfig();
      setup(this.config);
    }
    subscriberId() {
      return js_cookie_default.get(`${SUBSCRIBER_COOKIE}-${this.config.uuid}`) || getUrlParam("subscriber_id");
    }
    async fetch({ email = null, campaign = null } = {}) {
      const subscriber = isTestMode() ? "fake_subscriber" : email || this.subscriberId();
      if (!subscriber) {
        return Promise.reject("Subscriber ID or email not present");
      }
      let subscriberFormData2 = subscriberFormData();
      if (campaign) {
        subscriberFormData2.campaign_id = campaign;
      }
      try {
        const response = await fetchSubscriber(subscriber, subscriberFormData2);
        this.store(response);
        return Promise.resolve(response);
      } catch (e3) {
        return Promise.reject(e3);
      }
    }
    async upsert({ subscriber = null, campaign = null } = {}) {
      const subscriber_id = isTestMode() ? "fake_subscriber" : subscriber;
      if (!subscriber_id) {
        return Promise.reject();
      }
      let subscriberFormData2 = subscriberFormData();
      if (campaign) {
        subscriberFormData2.campaign_id = campaign;
      }
      try {
        const response = await upsertSubscriber(subscriber_id, subscriberFormData2);
        this.store(response);
        return Promise.resolve(response);
      } catch (e3) {
        return Promise.reject(e3);
      }
    }
    store(subscriber) {
      subscriberData(subscriber);
      storeCookie(`${SUBSCRIBER_COOKIE}-${this.config.uuid}`, subscriber.id);
      triggerEvent("subscriber-loaded");
      console.log(`Subscriber set`, { subscriber });
    }
  };

  // node_modules/snarkdown/dist/snarkdown.es.js
  var e2 = { "": ["<em>", "</em>"], _: ["<strong>", "</strong>"], "*": ["<strong>", "</strong>"], "~": ["<s>", "</s>"], "\n": ["<br />"], " ": ["<br />"], "-": ["<hr />"] };
  function n(e3) {
    return e3.replace(RegExp("^" + (e3.match(/^(\t| )+/) || "")[0], "gm"), "");
  }
  function r(e3) {
    return (e3 + "").replace(/"/g, "&quot;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
  }
  function t(a, c) {
    var o, l, g, s, p, u = /((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm, m = [], h = "", i = c || {}, d = 0;
    function f(n2) {
      var r2 = e2[n2[1] || ""], t2 = m[m.length - 1] == n2;
      return r2 ? r2[1] ? (t2 ? m.pop() : m.push(n2), r2[0 | t2]) : r2[0] : n2;
    }
    function $() {
      for (var e3 = ""; m.length; )
        e3 += f(m[m.length - 1]);
      return e3;
    }
    for (a = a.replace(/^\[(.+?)\]:\s*(.+)$/gm, function(e3, n2, r2) {
      return i[n2.toLowerCase()] = r2, "";
    }).replace(/^\n+|\n+$/g, ""); g = u.exec(a); )
      l = a.substring(d, g.index), d = u.lastIndex, o = g[0], l.match(/[^\\](\\\\)*\\$/) || ((p = g[3] || g[4]) ? o = '<pre class="code ' + (g[4] ? "poetry" : g[2].toLowerCase()) + '"><code' + (g[2] ? ' class="language-' + g[2].toLowerCase() + '"' : "") + ">" + n(r(p).replace(/^\n+|\n+$/g, "")) + "</code></pre>" : (p = g[6]) ? (p.match(/\./) && (g[5] = g[5].replace(/^\d+/gm, "")), s = t(n(g[5].replace(/^\s*[>*+.-]/gm, ""))), p == ">" ? p = "blockquote" : (p = p.match(/\./) ? "ol" : "ul", s = s.replace(/^(.*)(\n|$)/gm, "<li>$1</li>")), o = "<" + p + ">" + s + "</" + p + ">") : g[8] ? o = '<img src="' + r(g[8]) + '" alt="' + r(g[7]) + '">' : g[10] ? (h = h.replace("<a>", '<a href="' + r(g[11] || i[l.toLowerCase()]) + '">'), o = $() + "</a>") : g[9] ? o = "<a>" : g[12] || g[14] ? o = "<" + (p = "h" + (g[14] ? g[14].length : g[13] > "=" ? 1 : 2)) + ">" + t(g[12] || g[15], i) + "</" + p + ">" : g[16] ? o = "<code>" + r(g[16]) + "</code>" : (g[17] || g[1]) && (o = f(g[17] || "--"))), h += l, h += o;
    return (h + a.substring(d) + $()).replace(/^\n+|\n+$/g, "");
  }

  // app/javascript/script/components.js
  var createElement2 = createElement;
  var Components = class {
    constructor({ referral_hub = {}, upscribe: upscribe2 = {} } = {}) {
      this.config = globalConfig();
      this.referral_hub = referral_hub;
      this.upscribe = upscribe2;
      setup(this.config);
    }
    animateCSS = (element, animation) => new Promise((resolve, reject) => {
      element.classList.add(animation);
      function handleAnimationEnd(event) {
        event.stopPropagation();
        element.classList.remove(animation);
        resolve("Animation ended");
      }
      element.addEventListener("animationend", handleAnimationEnd, { once: true });
    });
    socialSharingLink = (socials, social) => {
      let sharing_link;
      if (social === "facebook") {
        sharing_link = "https://www.facebook.com/sharer.php?u=" + encodeURIComponent(this.referralLink("facebook"));
      } else if (social === "twitter") {
        sharing_link = "https://twitter.com/intent/tweet?text=" + encodeURIComponent(socials.twitter.message + "\n\n" + this.referralLink("twitter"));
      } else if (social === "email") {
        sharing_link = "mailto:?subject=" + encodeURIComponent(socials.email.subject) + "&body=" + encodeURIComponent(socials.email.message + "\n\n" + this.referralLink("email"));
      } else if (social === "whatsapp") {
        sharing_link = "https://api.whatsapp.com/send?text=" + encodeURIComponent(socials.whatsapp.message + "\n\n" + this.referralLink("whatsapp"));
      } else if (social === "facebook_messenger") {
        sharing_link = this.messengerLink();
      } else if (social === "linkedin") {
        sharing_link = "https://www.linkedin.com/shareArticle?mini=true&url=" + encodeURIComponent(this.referralLink("linkedin"));
      } else if (social === "reddit") {
        sharing_link = "https://www.reddit.com/submit?url=" + encodeURIComponent(this.referralLink("reddit")) + "&title=" + socials.reddit.message;
      } else if (social === "telegram") {
        sharing_link = "https://t.me/share/url?url=" + encodeURIComponent(this.referralLink("telegram")) + "&text" + encodeURIComponent(socials.telegram.message);
      } else if (social === "line") {
        sharing_link = "https://line.me/R/msg/text/?" + encodeURIComponent(socials.line.message + "\n\n" + this.referralLink("line"));
      }
      return sharing_link;
    };
    referralLink = (social = null) => {
      const subscriber = subscriberData();
      if (subscriber) {
        let reflink = subscriber.referral_link;
        if (social) {
          reflink += `?utm_source=${social}`;
        }
        return reflink;
      } else {
        return this.config.app_url + "?rh_ref=ABC123";
      }
    };
    messengerLink = () => {
      let url;
      if (/Mobi|Android/i.test(navigator.userAgent)) {
        url = "fb-messenger://share?redirect_uri=" + encodeURIComponent(this.config.default_url) + "&amp;link=" + encodeURIComponent(this.referralLink("facebook_messenger"));
      } else {
        url = "https://www.facebook.com/dialog/send?app_id=189109296592814&link=" + encodeURIComponent(this.referralLink("facebook_messenger")) + "&redirect_uri=" + encodeURIComponent(this.config.default_url);
      }
      return url;
    };
    poweredByLink = (source, parent) => {
      const powered_by_url = "https://sparkloop.app?utm_campaign=powered-by&utm_source=" + source + "&utm_medium=" + this.config.uuid;
      const el = createElement2({
        type: "a",
        attributes: {
          "href": powered_by_url,
          "target": "_blank"
        },
        text: "\u26A1\uFE0F by SparkLoop",
        parent
      });
      return el;
    };
    formWidget = ({ onSubmit }) => {
      const { form_widget } = this.referral_hub;
      if (form_widget.cover_image.enabled) {
        preloadAsset(form_widget.cover_image.url);
      }
      const containerEl = createElement2({ id: "sl-form-screen", classes: "sl-widget-body" });
      if (form_widget.cover_image.enabled) {
        containerEl.classList.add("sl-cover-image", "sl-cover-image--" + form_widget.cover_image.position);
        const coverImageContainerEl = createElement2({ type: "figure", parent: containerEl });
        createElement2({ type: "img", attributes: { "src": form_widget.cover_image.url }, parent: coverImageContainerEl });
      }
      const formSectionEl = createElement2({ type: "section", id: "sl-form-section", classes: "sl-form-section", parent: containerEl });
      const formSectionDivEl = createElement2({ classes: "sl-form-content", parent: formSectionEl });
      if (form_widget.header) {
        createElement2({ type: "h2", html: t(form_widget.header), parent: formSectionDivEl });
      }
      if (form_widget.subheader) {
        createElement2({ type: "p", html: t(form_widget.subheader), parent: formSectionDivEl });
      }
      const formEl = createElement2({ type: "form", parent: formSectionEl, attributes: { "data-sparkloop-form-ignore": true } });
      const formContainerEl = createElement2({ classes: "sl-form-container", parent: formEl });
      if (form_widget.form.name_input.enabled) {
        let name_input_attributes = {
          "type": "text",
          "name": "name",
          "placeholder": form_widget.form.name_input.placeholder
        };
        if (!isTestMode()) {
          name_input_attributes["required"] = true;
        }
        createElement2({ type: "input", attributes: name_input_attributes, parent: formContainerEl });
      }
      let email_input_attributes = {
        "type": "email",
        "name": "email",
        "placeholder": form_widget.form.email_input.placeholder
      };
      if (!isTestMode()) {
        email_input_attributes["required"] = true;
      }
      const emailInputEl = createElement2({ type: "input", attributes: email_input_attributes, parent: formContainerEl });
      const btnEl = createElement2({ type: "button", attributes: { "type": "submit" }, classes: "sl-button", text: form_widget.form.button.label, parent: formContainerEl });
      formEl.addEventListener("submit", (e3) => {
        e3.preventDefault();
        e3.stopPropagation();
        if (emailInputEl.value.length > 0) {
          btnEl.disabled = true;
          onSubmit(emailInputEl.value).catch((e4) => {
            console.log(e4);
            btnEl.disabled = false;
          });
        }
      });
      const footerEl = createElement2({ type: "footer", parent: formSectionEl });
      if (form_widget.tabs.how_it_works.enabled) {
        const howItWorksLinkEl = createElement2({ type: "a", attributes: { "href": "#" }, text: form_widget.tabs.how_it_works.label, parent: footerEl });
        howItWorksLinkEl.addEventListener("click", (e3) => {
          e3.preventDefault();
          e3.stopPropagation();
          this.animateCSS(formSectionEl, "sl-fadeOutLeft").then((message2) => {
            formSectionEl.style.display = "none";
            howItWorksSectionEl.style.display = "flex";
          });
        });
        createElement2({ type: "span", text: "|", parent: footerEl });
      }
      if (form_widget.tabs.terms.enabled) {
        createElement2({ type: "a", attributes: { "href": form_widget.tabs.terms.url }, text: form_widget.tabs.terms.label, parent: footerEl });
        createElement2({ type: "span", text: "|", parent: footerEl });
      }
      if (this.referral_hub.styling.powered_by_enabled) {
        this.poweredByLink("referral-hub", footerEl);
      }
      const howItWorksSectionEl = createElement2({ type: "section", id: "sl-how-it-works-section", classes: "sl-section-large", parent: containerEl });
      howItWorksSectionEl.style.display = "none";
      const howItWorksSectionBackButtonEl = createElement2({
        type: "a",
        classes: "sl-back-button",
        html: `
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
              <g>
                <path d="M256,0C114.8,0,0,114.8,0,256s114.8,256,256,256s256-114.8,256-256S397.2,0,256,0z M256,39.4
                  c119.8,0,216.6,96.8,216.6,216.6S375.8,472.6,256,472.6S39.4,375.8,39.4,256S136.2,39.4,256,39.4z M196.9,177.2L118.2,256
                  l78.8,78.8v-59.1h196.9v-39.4H196.9V177.2z"/>
              </g>
              </svg>
              <span>Back</span>
            `,
        attributes: { "href": "#" },
        parent: howItWorksSectionEl
      });
      howItWorksSectionBackButtonEl.addEventListener("click", (e3) => {
        e3.preventDefault();
        e3.stopPropagation();
        this.animateCSS(howItWorksSectionEl, "sl-fadeOutRight").then((message2) => {
          formSectionEl.style.display = "flex";
          howItWorksSectionEl.style.display = "none";
        });
      });
      createElement2({ type: "h2", text: form_widget.tabs.how_it_works.label, parent: howItWorksSectionEl });
      createElement2({ type: "article", html: t(form_widget.tabs.how_it_works.content), parent: howItWorksSectionEl });
      return containerEl;
    };
    rewardsElement = () => {
      const subscriber = subscriberData();
      if (!subscriber) {
        return;
      }
      const { hub_widget } = this.referral_hub;
      const rewardList = hub_widget.rewards.list;
      const rewardLayout = hub_widget.rewards.layout;
      const rewardsContainerEl = createElement2({ type: "ul", id: "sl-rewards-section" });
      rewardsContainerEl.classList.add(`sl-rewards-layout-${rewardLayout}`);
      rewardList.forEach((reward, index) => {
        index++;
        const rewardIsWon = subscriber.rewards_won.includes(reward.id);
        const rewardEl = createElement2({ type: "li", classes: "sl-reward", parent: rewardsContainerEl });
        if (rewardIsWon) {
          rewardEl.classList.add("sl-reward-won");
        }
        const rewardImageEl = createElement2({ type: "figure", classes: "sl-reward-image", parent: rewardEl });
        rewardImageEl.style.backgroundImage = 'url("' + reward.image + '")';
        const rewardReferralsEl = createElement2({ classes: "sl-reward-referrals", parent: rewardImageEl });
        if (rewardIsWon) {
          createElement2({
            type: "span",
            parent: rewardReferralsEl,
            html: `<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 36 36'>
                            <path fill='#fff' d="M12.8,28.7l-9.5-9.5c-0.4-0.4-0.4-1.1,0-1.6l1.5-1.5c0.4-0.4,1.1-0.4,1.6,0l7.2,7.2   l16-16c0.4-0.4,1.1-0.4,1.6,0l1.5,1.5c0.4,0.4,0.4,1.1,0,1.6L14.4,28.7C13.9,29.1,13.2,29.1,12.8,28.7z"/>
                          </svg>`
          });
        } else {
          createElement2({ type: "span", text: reward.referrals, parent: rewardReferralsEl });
        }
        const rewardInfoEl = createElement2({ classes: "sl-reward-info", parent: rewardEl });
        createElement2({ type: "h4", text: reward.name, parent: rewardInfoEl });
        if (reward.description) {
          if (rewardLayout == "horizontal") {
            const rewardDescriptionEl = createElement2({ classes: "sl-reward-description hide", parent: rewardImageEl });
            createElement2({ type: "p", text: reward.description, parent: rewardDescriptionEl });
            const rewardDescriptionButton = createElement2({
              type: "span",
              parent: rewardInfoEl,
              html: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill='currentColor'>
                          <path fill='currentColor' d="M12,2A10,10,0,1,0,22,12,10.01114,10.01114,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8.00917,8.00917,0,0,1,12,20Zm0-8.5a1,1,0,0,0-1,1v3a1,1,0,0,0,2,0v-3A1,1,0,0,0,12,11.5Zm0-4a1.25,1.25,0,1,0,1.25,1.25A1.25,1.25,0,0,0,12,7.5Z"/>
                        </svg>`
            });
            rewardDescriptionButton.addEventListener("click", function(e3) {
              rewardDescriptionEl.classList.toggle("hide");
            });
          } else {
            createElement2({ type: "p", text: reward.description, parent: rewardInfoEl });
          }
        }
        if (rewardList.length < 6 || index == 1 || index == rewardList.length) {
          return;
        }
        if (rewardList.length % 5 == 0) {
          if (index % 5 == 0) {
            rewardEl.classList.add("sl-before-break");
            createElement2({ type: "span", classes: "sl-reward-break", parent: rewardsContainerEl });
          }
        } else if (rewardList.length % 4 == 0) {
          if (index % 4 == 0) {
            rewardEl.classList.add("sl-before-break");
            createElement2({ type: "span", classes: "sl-reward-break", parent: rewardsContainerEl });
          }
        } else if (rewardList.length % 3 == 0) {
          if (index % 3 == 0) {
            rewardEl.classList.add("sl-before-break");
            createElement2({ type: "span", classes: "sl-reward-break", parent: rewardsContainerEl });
          }
        } else if (index % 4 == 0) {
          rewardEl.classList.add("sl-before-break");
          createElement2({ type: "span", classes: "sl-reward-break", parent: rewardsContainerEl });
        }
      });
      return rewardsContainerEl;
    };
    sharingElement = () => {
      const subscriber = subscriberData();
      if (!subscriber) {
        return;
      }
      const { hub_widget } = this.referral_hub;
      const sharingContainerEl = createElement2({ type: "section", id: "sl-sharing-section" });
      const sharingLinkContainerEl = createElement2({ id: "sl-sharinglink-container", parent: sharingContainerEl });
      createElement2({ type: "p", text: hub_widget.sharing.referral_link.header, parent: sharingLinkContainerEl });
      sharingLinkContainerEl.appendChild(this.referralLinkElement());
      if (hub_widget.sharing.social_links.enabled) {
        const socialLinksContainerEl = createElement2({ id: "sl-sociallinks-container", parent: sharingContainerEl });
        createElement2({ type: "p", text: hub_widget.sharing.social_links.header, parent: socialLinksContainerEl });
        socialLinksContainerEl.appendChild(this.socialIconsElement());
      }
      if (hub_widget.sharing.email_invitation.enabled) {
        const emailInvitationContainerEl = createElement2({ id: "sl-emailinvitation-container", parent: sharingContainerEl });
        createElement2({ type: "p", text: hub_widget.sharing.email_invitation.header, parent: emailInvitationContainerEl });
        const confirmationMessage = createElement2({ type: "span" });
        emailInvitationContainerEl.appendChild(this.emailInvitationElement(confirmationMessage));
        emailInvitationContainerEl.appendChild(confirmationMessage);
      }
      return sharingContainerEl;
    };
    referralLinkElement = () => {
      const subscriber = subscriberData();
      if (!subscriber) {
        return;
      }
      const { sharing } = this.referral_hub.hub_widget;
      const container = createElement2({ type: "form", attributes: { "data-sparkloop-form-ignore": true } });
      const sharingLinkInputEl = createElement2({ type: "input", parent: container, attributes: { "type": "text", "readonly": true, "value": subscriber.referral_link } });
      const sharingLinkButtonEl = createElement2({ type: "button", classes: "sl-button", parent: container, text: sharing.referral_link.button.label });
      sharingLinkButtonEl.addEventListener("click", (event) => {
        event.preventDefault();
        copyToClipboard(sharingLinkInputEl, sharingLinkButtonEl, sharing.referral_link.button.label);
      });
      return container;
    };
    statsElement = () => {
      const subscriber = subscriberData();
      if (!subscriber) {
        return;
      }
      const { referrals } = this.referral_hub.hub_widget;
      const container = createElement2({ type: "section", id: "sl-referrals-section" });
      if (referrals.confirmed.enabled) {
        const confirmedReferralsEl = createElement2({ id: "sl-confirmed-referrals", parent: container });
        createElement2({ type: "h3", text: numberWithCommas(subscriber.referrals.confirmed), parent: confirmedReferralsEl });
        createElement2({ type: "span", text: referrals.confirmed.label, parent: confirmedReferralsEl });
      }
      if (referrals.pending.enabled) {
        const pendingReferralsEl = createElement2({ id: "sl-pending-referrals", parent: container });
        createElement2({ type: "h3", text: numberWithCommas(subscriber.referrals.pending), parent: pendingReferralsEl });
        createElement2({ type: "span", text: referrals.pending.label, parent: pendingReferralsEl });
      }
      if (referrals.next.enabled) {
        const nextReferralsEl = createElement2({ id: "sl-next-referrals", parent: container });
        createElement2({ type: "h3", text: numberWithCommas(subscriber.next_reward), parent: nextReferralsEl });
        createElement2({ type: "span", text: referrals.next.label, parent: nextReferralsEl });
      }
      return container;
    };
    socialIconsElement = () => {
      const subscriber = subscriberData();
      if (!subscriber) {
        return;
      }
      const { hub_widget } = this.referral_hub;
      const socialsContainerEl = createElement2({ id: "sl-sociallinks-icons" });
      const socials = ["twitter", "facebook", "email", "whatsapp", "linkedin", "telegram"];
      socials.forEach((social) => {
        if (hub_widget.sharing.social_links.socials[social].enabled) {
          const socialEl = createElement2({ type: "a", classes: "sl-social", id: `sl-social-${social}`, attributes: { "title": `Share on ${social}`, "href": this.socialSharingLink(hub_widget.sharing.social_links.socials, social) } });
          socialEl.style.backgroundImage = "url(https://sparkloop-static-images.s3-us-west-1.amazonaws.com/" + social + ".png)";
          socialsContainerEl.appendChild(socialEl);
        }
      });
      return socialsContainerEl;
    };
    emailInvitationElement = (confirmationMessageEl) => {
      const subscriber = subscriberData();
      if (!subscriber) {
        return;
      }
      const { email_invitation } = this.referral_hub.hub_widget.sharing;
      setup(this.config);
      const container = createElement2({ type: "form", attributes: { "data-sparkloop-form-ignore": true } });
      const emailInput = createElement2({ type: "input", parent: container, classes: "sl-widget-input", attributes: { "type": "text", "placeholder": email_invitation.placeholder } });
      const buttonEl = createElement2({ type: "button", classes: "sl-button", parent: container, text: email_invitation.button.label });
      buttonEl.addEventListener("click", async (event) => {
        event.preventDefault();
        event.stopPropagation();
        buttonEl.disabled = true;
        confirmationMessageEl.innerText = "";
        const recipients = emailInput.value.trim();
        if (recipients.length > 0) {
          const params = {
            campaign_id: this.referral_hub.campaign_id,
            subscriber: subscriber.id,
            recipients
          };
          try {
            await sendEmailInvitation(params);
            emailInput.value = "";
            confirmationMessageEl.innerText = email_invitation.confirmation_message;
          } catch (error2) {
            confirmationMessageEl.innerText = "Server error. Please try again.";
          } finally {
            buttonEl.disabled = false;
          }
        }
      });
      return container;
    };
    hubWidget = () => {
      const subscriber = subscriberData();
      if (!subscriber) {
        return;
      }
      const { hub_widget } = this.referral_hub;
      hub_widget.rewards.list.forEach((reward) => {
        preloadAsset(reward.image);
      });
      const containerEl = createElement2({ id: "sl-hub-screen", classes: "sl-widget-body" });
      if (hub_widget.header && hub_widget.header.trim().length > 0 || hub_widget.subheader && hub_widget.subheader.trim().length > 0) {
        const headerEl = createElement2({ type: "header", parent: containerEl });
        if (hub_widget.header && hub_widget.header.trim().length > 0) {
          createElement2({ type: "h2", html: t(hub_widget.header), parent: headerEl });
        }
        if (hub_widget.subheader && hub_widget.subheader.trim().length > 0) {
          createElement2({ type: "p", html: t(hub_widget.subheader), parent: headerEl });
        }
      }
      if (hub_widget.rewards.enabled && hub_widget.rewards.list.length > 0) {
        containerEl.appendChild(this.rewardsElement());
      }
      const hubMainEl = createElement2({ type: "main", id: "sl-hub-main", parent: containerEl });
      hubMainEl.appendChild(this.sharingElement());
      if (hub_widget.referrals.confirmed.enabled || hub_widget.referrals.pending.enabled || hub_widget.referrals.next.enabled) {
        hubMainEl.appendChild(this.statsElement());
      }
      if (this.referral_hub.styling.powered_by_enabled) {
        const poweredByLinkContainerEl = createElement2({ id: "sl-hub-powered-by", parent: containerEl });
        this.poweredByLink("referral-hub", poweredByLinkContainerEl);
      }
      return containerEl;
    };
    upscribeWidget = (email) => {
      const subscriber = subscriberData();
      const upscribe2 = this.upscribe;
      const url = new URL(upscribe2.redirect_url);
      url.searchParams.append("email", email);
      url.searchParams.append("ref", this.config.widgets.upscribe_ref);
      const redirect_url = url.toString();
      const formButtonEl = createElement2({ type: "button", attributes: { type: "submit" }, text: upscribe2.button_label, classes: "sl-button" });
      const containerEl = createElement2({ type: "form", id: "sparkloop-upscribe", classes: "sl-widget-body", attributes: { "data-sparkloop-form-ignore": true } });
      containerEl.addEventListener("submit", async function(evt) {
        evt.preventDefault();
        const publicationsSelected = containerEl.querySelectorAll('input[type="checkbox"]:checked');
        if (publicationsSelected.length > 0 && subscriber) {
          formButtonEl.disabled = true;
          const data = {
            subscriber: isTestMode() ? "fake_subscriber" : subscriber.id,
            upscribe_id: upscribe2.uuid,
            partner_campaigns: Array.from(publicationsSelected).map((x) => x.value)
          };
          try {
            await upscribe(data);
            window.location.href = redirect_url;
          } catch (e3) {
            console.log(e3);
          } finally {
            formButtonEl.disabled = false;
          }
        }
      });
      if (isTestMode()) {
        containerEl.classList.add("no-animation");
      }
      const headerEl = createElement2({ type: "header", parent: containerEl });
      if (upscribe2.header) {
        createElement2({ type: "h2", text: upscribe2.header, parent: headerEl });
      }
      createElement2({ type: "p", text: upscribe2.subheader, parent: headerEl });
      const publicationsListEl = createElement2({ type: "ul", parent: containerEl });
      upscribe2.publications.forEach((partner_campaign) => {
        const publicationEl = createElement2({ type: "li", parent: publicationsListEl });
        const publicationLabelEl = createElement2({ type: "label", attributes: { for: `partner_campaign_${partner_campaign.ref_code}` }, parent: publicationEl });
        const publicationMainEl = createElement2({ type: "main", parent: publicationLabelEl });
        createElement2({ type: "img", attributes: { src: partner_campaign.publication_logo }, parent: publicationMainEl });
        const publicationInfoEl = createElement2({ type: "div", parent: publicationMainEl });
        createElement2({ type: "h3", text: partner_campaign.publication_name, parent: publicationInfoEl });
        createElement2({ type: "p", text: partner_campaign.description, parent: publicationInfoEl });
        const publicationToggleEl = createElement2({ parent: publicationLabelEl, classes: "sl-upscribe-checkbox" });
        const toggleCheckboxEl = createElement2({ type: "input", id: `partner_campaign_${partner_campaign.ref_code}`, attributes: {
          "type": "checkbox",
          "checked": "true",
          "name": "partner_campaigns[]",
          "value": partner_campaign.ref_code
        }, parent: publicationToggleEl });
        toggleCheckboxEl.addEventListener("change", function(evt) {
          const publicationsSelected = publicationsListEl.querySelectorAll('input[type="checkbox"]:checked');
          formButtonEl.disabled = publicationsSelected.length === 0;
        });
        const toggleLabelEl = createElement2({ type: "span", parent: publicationToggleEl });
      });
      if (upscribe2.publications.length === 0) {
        createElement2({ type: "div", classes: "sl-instructions", text: "+ Add publications", parent: containerEl });
      }
      const footerEl = createElement2({ type: "footer", parent: containerEl });
      if (upscribe2.publications.length > 0) {
        footerEl.appendChild(formButtonEl);
        createElement2({ type: "a", text: upscribe2.skip_link, attributes: { "href": redirect_url }, classes: "sl-skip-link", parent: footerEl });
      }
      if (upscribe2.styling.powered_by_enabled) {
        const poweredByEl = createElement2({ type: "p", id: "sl-hub-powered-by", parent: footerEl });
        this.poweredByLink("upscribe", poweredByEl);
      }
      return containerEl;
    };
  };

  // app/javascript/script/upscribe.js
  var Upscribe = class {
    constructor() {
      this.config = globalConfig();
      this.upscribe = {};
    }
    async load() {
      this.fetchSettings();
      await this.loadStyles();
      const overlay = document.createElement("div");
      overlay.id = "sl-overlay";
      overlay.replaceChildren(this.generateWidget());
      document.body.appendChild(overlay);
    }
    generateWidget() {
      const components = new Components({ upscribe: this.upscribe });
      return components.upscribeWidget();
    }
    loadStyles() {
      this.upscribe.publications.forEach((publication) => preloadAsset(publication.publication_logo));
      loadStylesheet("upscribe");
      document.documentElement.style.setProperty("--sl-widgets-upscribe-primary-color", this.upscribe.styling.colors.primary);
      loadCustomCSS("upscribe", this.upscribe.styling.custom_css);
    }
    fetchSettings(upscribe_id) {
      const upscribes = this.config.widgets.upscribes;
      this.upscribe = upscribe_id ? upscribes.find((upscribe2) => upscribe2.uuid == upscribe_id) : upscribes[0];
    }
  };

  // app/javascript/script/forms.js
  var Forms = class {
    constructor() {
      this.config = globalConfig();
      this.formId = 0;
      this.submittedFormsIds = [];
      setup(this.config);
    }
    track() {
      if (!this.config.scan_forms) {
        return;
      }
      this.trackStandardForms();
      document.addEventListener("pico.user.registered", (evt) => this.trackPicoForms(evt));
      document.addEventListener("pico.user.registered", (evt) => this.trackPicoForms(evt));
      document.addEventListener("klaviyoForms", (evt) => this.trackOptinMonsterForms(evt));
      document.addEventListener("MemberSpace.conversion", (evt) => this.trackMemberSpaceForms(evt));
      this.trackElementorForms();
      this.trackSquareSpaceForms();
      this.trackDynamicForms();
    }
    trackForm(form) {
      if (form.hasAttribute("data-sparkloop-form-ignore")) {
        return;
      }
      if (!form.hasAttribute("data-sparkloop-form-id")) {
        this.formId++;
        form.dataset.sparkloopFormId = this.formId;
        console.log("tracking form", form);
        form.addEventListener("submit", (e3) => this.combFormForEmail(form));
      }
    }
    trackStandardForms() {
      const forms = document.querySelectorAll(this.config.form_selector || "form");
      forms.forEach((form) => {
        this.trackForm(form);
      });
    }
    trackDynamicForms() {
      const callbackFn = (mutationList) => {
        mutationList.forEach((mutation) => {
          mutation.target.querySelectorAll("form").forEach((form) => {
            this.trackForm(form);
          });
        });
      };
      const observer = new MutationObserver(callbackFn);
      observer.observe(document.body, { childList: true, subtree: true });
    }
    trackKlaviyoForms(evt) {
      if (evt.detail.type == "submit" || evt.detail.type == "stepSubmit") {
        visitorData({ email: evt.detail.metaData.$email.trim() });
        this.captureSubscriber();
      }
    }
    trackPicoForms(evt) {
      visitorData({ email: evt.detail.email.trim() });
      this.captureSubscriber();
    }
    trackOptinMonsterForms(evt) {
      visitorData({ email: evt.detail.Optin.data.fields.email.trim() });
      this.captureSubscriber();
    }
    trackElementorForms() {
      if (window.jQuery) {
        const iCanUseOn = !!jQuery.fn.on;
        const callerFn = (e3) => this.combFormForEmail(e3.target);
        iCanUseOn ? jQuery(document).on("submit_success", callerFn) : jQuery(document).bind("submit_success", callerFn);
      }
    }
    trackMemberSpaceForms({ detail }) {
      const { order, plan, member } = detail;
      visitorData({ email: member.email.trim() });
      this.captureSubscriber();
    }
    trackSquareSpaceForms() {
      if (typeof Y !== "undefined" && typeof Y.all === "function") {
        Y.all("form").each(function(yform) {
          yform.on("submit", function() {
            const form = document.querySelector(yform._node);
            if (form) {
              this.trackForm(form);
            }
          });
        });
      }
    }
    combFormForEmail(form) {
      if (this.submittedFormsIds.includes(form.dataset.formId)) {
        return;
      }
      const emailEl = detectEmailInForm(form);
      if (emailEl) {
        triggerEvent("form-submitted");
        console.log("email input detected", emailEl);
        this.submittedFormsIds.push(form.dataset.formId);
        visitorData({ email: emailEl.value.trim() });
        this.captureSubscriber({ form });
      }
    }
    async captureSubscriber({ form = null } = {}) {
      const subscriberFormData2 = subscriberFormData();
      if (!subscriberFormData2.email) {
        console.log("No email found in the form submission");
      }
      if (isVerificationMode()) {
        try {
          const campaign_id = getUrlParam("SLVerifyInstall");
          subscriberFormData2.campaign_id = campaign_id;
          await testReferral(subscriberFormData2);
          success("[Step 3 of 3] Referral tracking working successfully", "SparkLoop was able to track the referral correctly via your form.\n\nPS: If your form normally redirects to another page, don't worry. We have temporarily disabled the redirect to test the referral.\n\n\u{1F449} you'll be redirected back to SparkLoop in a few seconds...");
          setTimeout(() => {
            window.open(`${this.config.app_url}/campaigns/${campaign_id}/checklist/script?verified=true`, "_blank");
          }, 4e3);
        } catch (error2) {
          console.log(error2.message);
        }
      } else {
        if (subscriberFormData2.email) {
          const upscribeEnabled = this.upscribeEnabled(form);
          try {
            const response = await subscribe(subscriberFormData2, { ajax: upscribeEnabled });
            if (typeof response === "object") {
              subscriberData(response.subscriber);
            }
            if (upscribeEnabled) {
              this.loadUpscribe();
            }
          } catch (error2) {
            console.log(err);
          }
        }
      }
    }
    upscribeEnabled(form) {
      if (isVerificationMode()) {
        return;
      }
      console.log("yep");
      const upscribe2 = this.config.widgets.upscribes[0];
      if (upscribe2 && upscribe2.enabled) {
        if (upscribe2.visibility.all_pages) {
          return form && form.dataset.sparkloopUpscribe != "false";
        } else {
          return form && form.dataset.sparkloopUpscribe == "true";
        }
      } else {
        return false;
      }
    }
    loadUpscribe() {
      const upscribe2 = new Upscribe();
      upscribe2.load();
    }
  };

  // app/javascript/script/widgets.js
  var Widgets = class {
    constructor() {
      this.config = globalConfig();
      this.referral_hub = {};
    }
    async load() {
      this.loadDefaultStyles();
      if (this.config.widgets.referral_hubs.length) {
        this.fetchReferralHubSettings();
        if (Object.keys(this.referral_hub).length) {
          try {
            const subscriber = new Subscriber();
            await subscriber.fetch({ campaign: this.referral_hub.campaign_id });
          } catch (error2) {
            console.error(`Subscriber was not found`);
          }
          if (isTestMode() && showFlashMessages()) {
            message("Referral Hub Preview", 'To visualize the hub widget, signup using any name<br/>and "test@test.com" as email address.<br>When test mode is enabled no email will be recorded.');
          }
          this.loadReferralHubStyles();
          this.loadReferralHubWidget();
          this.generateReferralHubElements();
        }
      }
    }
    components() {
      return widgetsAllowed() ? new Components({ referral_hub: this.referral_hub }) : proxyComponents();
    }
    fetchReferralHubSettings(campaignId) {
      const referral_hubs = this.config.widgets.referral_hubs;
      if (campaignId) {
        this.referral_hub = referral_hubs.find((hub) => hub.campaign_id == campaignId);
      } else {
        const selector = document.querySelector("#sparkloop-referral-hub") || document.querySelector("[referral-hub-element]");
        if (selector) {
          const campaignAttribute = selector.dataset.campaignId;
          this.referral_hub = campaignAttribute ? referral_hubs.find((hub) => hub.campaign_id == campaignAttribute) : referral_hubs[0];
        }
      }
    }
    loadReferralHubWidget() {
      const selector = document.querySelector("#sparkloop-referral-hub");
      if (!selector) {
        return;
      }
      if (subscriberData()) {
        selector.replaceChildren(this.generateHubWidget());
      } else {
        selector.replaceChildren(this.generateFormWidget());
      }
    }
    generateFormWidget() {
      return this.components().formWidget({ onSubmit: (email) => this.validateAndHydrateSubscriber(email) });
    }
    generateHubWidget() {
      return this.components().hubWidget();
    }
    generateRewardsElement() {
      return this.components().rewardsElement();
    }
    generateSharingElement() {
      return this.components().sharingElement();
    }
    generateStatsElement() {
      return this.components().statsElement();
    }
    generateReferralHubElements() {
      if (subscriberData()) {
        const wrapElement = (selector, element) => {
          const parent = document.createElement("div");
          parent.className = "sl-widget-body sl-referral-hub-element";
          parent.appendChild(element);
          selector.replaceChildren(parent);
        };
        document.querySelectorAll(`.sparkloop-rewards-element[data-campaign-id=${this.referral_hub.campaign_id}]`).forEach((el) => {
          wrapElement(el, this.generateRewardsElement());
        });
        document.querySelectorAll(`.sparkloop-sharing-element[data-campaign-id=${this.referral_hub.campaign_id}]`).forEach((el) => {
          wrapElement(el, this.generateSharingElement());
        });
        document.querySelectorAll(`.sparkloop-stats-element[data-campaign-id=${this.referral_hub.campaign_id}]`).forEach((el) => {
          wrapElement(el, this.generateStatsElement());
        });
      }
    }
    async validateAndHydrateSubscriber(email) {
      try {
        const subscriber = new Subscriber();
        await subscriber.upsert({ subscriber: email, campaign: this.referral_hub.campaign_id });
        this.loadReferralHubWidget();
        this.generateReferralHubElements();
      } catch (e3) {
        triggerEvent("subscriber-not-loaded");
        console.log(`Subscriber not loaded ${e3}`);
      }
    }
    loadDefaultStyles() {
      setDefaultCssVariables();
      loadStylesheet("default");
    }
    loadReferralHubStyles() {
      loadStylesheet("referral_hub");
      document.documentElement.style.setProperty("--sl-widgets-referral-hub-primary-color", this.referral_hub.styling.colors.primary);
      document.documentElement.style.setProperty("--sl-widgets-referral-hub-secondary-color", this.referral_hub.styling.colors.secondary);
      document.documentElement.style.setProperty("--sl-widgets-referral-hub-headers-color", this.referral_hub.styling.colors.headers);
      loadCustomCSS("referral_hub", this.referral_hub.styling.custom_css);
    }
  };

  // app/javascript/script/script_verification.js
  var ScriptVerification = class {
    constructor() {
      this.config = globalConfig();
      setup(this.config);
    }
    timeoutTime() {
      return getUrlParam("timeout") ? parseInt(getUrlParam("timeout")) : 15e3;
    }
    async run() {
      if (!isVerificationMode()) {
        return;
      }
      try {
        const params = {
          campaign_id: getUrlParam("SLVerifyInstall")
        };
        const response = await markVerified(params);
        console.log(`script verified successfully`, response);
        message("[Step 1 of 3] Script found on page", `Your SparkLoop tracking script is correctly installed on this page.

\u{1F449} let's make sure SparkLoop can identify your email signup form(s).`);
        this.verifyReferralTracking();
      } catch (error2) {
        error("Script verification failed", `Please reload the page and try again.`);
      }
    }
    fetchForms() {
      return document.querySelectorAll(this.config.form_selector || "form");
    }
    verifyReferralTracking() {
      setTimeout(() => {
        if (this.fetchForms().length) {
          this.revalidateForm();
        } else if (isGravityFormsWithoutEmail(this.fetchForms())) {
          warning("Gravity form detected", "SparkLoop has detected a broken Gravity form on this page. <a href='https://help.sparkloop.app/en/articles/5855767-installing-the-tracking-script-on-wordpress#h_f004b7693e' target='_blank'>See instructions</a> on how to fix it");
        } else {
          warning("We can't detect a valid form on this page", "SparkLoop will try for another 15 seconds.\n\n\u{1F449} if your form is inside a popup, try opening it (make the form appear on the page)");
          setTimeout(() => {
            if (this.fetchForms().length) {
              this.revalidateForm();
            } else {
              error("Bad news \u{1F61E}", "SparkLoop couldn't detect a valid form on this page.\n\nIf you get this error but your form is visible on the page, it's possible that your form is inside an iFrame or otherwise incompatible with our SparkLoop tracking script.\n\n\u{1F449} contact our support team (support@sparkloop.app) to find a solution.");
            }
          }, this.timeoutTime());
        }
      }, 1500);
    }
    revalidateForm() {
      message("[Step 2 of 3] Valid form found", "SparkLoop has detected a valid email signup form on this page.\n\nNow we need to check that our tracking script can track referrals correctly via your form.<br/><br/><strong>\u{1F449} fill out and submit your form using the email address referral@sparkloop.app</strong>");
      const forms = new Forms();
      forms.track();
      setTimeout(() => {
        if (!window.SL.visitor.email) {
          warning("Referral not yet detected", "SparkLoop hasn't been able to detect a valid referral yet.\n\n\u{1F449} if you haven't submitted the form yet using referral@sparkloop.app, please do so now.\n\nIf you have submitted your email signup form correctly, it's likely there's an error in your form which prevents us from tracking referrals correctly.\n\nIn this case, please contact our support team (support@sparkloop.app) and we'll help you find an easy solution!");
        }
      }, this.timeoutTime());
    }
  };

  // app/javascript/script/core.js
  var import_lodash = __toESM(require_lodash());
  var Sparkloop = class {
    constructor(config) {
      this.config = config;
    }
    widgets(campaign_id) {
      const widgets = new Widgets();
      widgets.fetchReferralHubSettings(campaign_id);
      widgets.loadReferralHubStyles();
      return widgets;
    }
    async upscribe(upscribe_id, email) {
      try {
        const subscriber = new Subscriber();
        await subscriber.fetch({ email: email.trim() });
        const upscribe2 = new Upscribe();
        upscribe2.fetchSettings(upscribe_id);
        upscribe2.loadStyles();
        return upscribe2.generateWidget();
      } catch (error2) {
        console.error(error2);
      }
    }
    generate = {
      rewardsElement: (campaign_id) => this.widgets(campaign_id).generateRewardsElement(),
      sharingElement: (campaign_id) => this.widgets(campaign_id).generateSharingElement(),
      statsElement: (campaign_id) => this.widgets(campaign_id).generateStatsElement(),
      formWidget: (campaign_id) => this.widgets(campaign_id).generateFormWidget(),
      hubWidget: (campaign_id) => this.widgets(campaign_id).generateHubWidget(),
      upscribeWidget: (upscribe_id, email) => this.upscribe(upscribe_id, email)
    };
    reset(config) {
      this.config = (0, import_lodash.default)(config, window.SLConfig);
    }
    trackSubscriber(email) {
      if (email) {
        visitorData({ email: email.trim() });
        const forms = new Forms();
        forms.captureSubscriber();
      } else {
        console.error(`Email can't be blank.`);
      }
    }
    async getSubscriber(email, campaign = null) {
      try {
        const subscriber = new Subscriber();
        const response = await subscriber.fetch({ email: email.trim(), campaign });
        return Promise.resolve(response);
      } catch (error2) {
        console.log(error2);
        return Promise.reject(error2);
      }
    }
    async run() {
      triggerEvent("ready");
      showTestModeBanner();
      const visitor = new Visitor();
      await visitor.profile();
      const scriptVerification = new ScriptVerification();
      scriptVerification.run();
      const forms = new Forms();
      forms.track();
      try {
        const subscriber = new Subscriber();
        await subscriber.fetch();
      } catch (error2) {
        triggerEvent("subscriber-not-loaded");
        console.log(error2);
      }
      const widgets = new Widgets();
      widgets.load();
    }
  };
  var init2 = (defaultConfig, otherConfig = null) => {
    if (!defaultConfig.active) {
      console.warn(`Sparkloop is disabled because the account is not active.`);
      return false;
    }
    const config = (0, import_lodash.default)(otherConfig || window.SL || {}, defaultConfig);
    window.SLConfig = defaultConfig;
    if (config.disabled) {
      console.warn(`SparkLoop has been manually disabled.`);
      return false;
    }
    if (config.test_mode) {
      console.warn(`SparkLoop is running in test mode.`);
    }
    console.log("\u{1F64C} SparkLoop is loaded, time to rock'n'roll!");
    console.log("Looking to grow your newsletter? Check out https://sparkloop.app/console");
    const sparkloop = new Sparkloop(config);
    window.SL = sparkloop;
    sparkloop.run();
  };
  if (false) {
    core_module.exports = async (uuid, otherConfig = null) => {
      const config = await api.fetchConfig(uuid);
      init2(config, otherConfig);
    };
  } else {
    const lazyInit = () => {
      setTimeout(() => {
        init2(window.SLConfig);
      }, window.sparkloop_delay || 800);
    };
    if (document.readyState !== "loading") {
      lazyInit();
    } else {
      document.addEventListener("DOMContentLoaded", () => lazyInit());
      document.addEventListener("turbo:load", () => lazyInit());
    }
  }
})();
/*! js-cookie v3.0.1 | MIT */

})();
